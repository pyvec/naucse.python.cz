
<!doctype html>
<html lang="cs">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>
            
                DatovÃ½ kurz PyLadies: InteraktivnÃ­ vizualizace a aplikace I.
            
        </title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">

        

        <link rel="stylesheet" href="/static/css/naucse.css">
        <link rel="stylesheet" href="/static/css/body.css">
        <link rel="stylesheet" href="/static/css/pygments-lovelace-style.css">
        <link rel="stylesheet" href="/static/css/ipython.css">

        
    


        <style>
            
    

        </style>
    </head>

    <body>
        <nav class="header">
            <ul class="container menu">
                <li><a href="/" class="logo"><h1>NauÄ se Python!</h1></a></li>
                <li><a href="/courses/" class="menu-link"><h2>MateriÃ¡ly</h2></a></li>
                <li><a href="/runs/" class="menu-link"><h2>Kurzy</h2></a></li>
            </ul>
        </nav>

        

<div class="page">
    <div class="container">

        
            <header class="lesson-header">
                <a href="/">NauÄ se Python </a>
                
                > <a href="/runs/">Kurzy</a>
                
                

> <a href="/2020/pydata-ostrava-jaro/">DatovÃ½ kurz PyLadies</a>

> <a href="/2020/pydata-ostrava-jaro/sessions/dashboards/">InteraktivnÃ­ vizualizace a aplikace</a>

> <a href="/2020/pydata-ostrava-jaro/pydata/dashboards/">InteraktivnÃ­ vizualizace a aplikace I.</a>


                <hr>
            </header>
        

        
  


        <div class="lesson-content">
          
    

    <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>InteraktivnÃ­ vizualizace a aplikace</h1>
<p>PÅ™i prÃ¡ci s daty je mnoho pÅ™Ã­leÅ¾itostÃ­, kdy se hodÃ­ interaktivita. PÅ™i vizualici se hodÃ­ zvÄ›tÅ¡ovÃ¡nÃ­ / zmÄ›nÅ¡ovÃ¡nÃ­ mÄ›Å™Ã­tka, vÃ½bÄ›r podoblasti, ukÃ¡zÃ¡nÃ­ vykreslenÃ½ch hodnot apod. Nebo pÅ™i datovÃ© anlÃ½ze obecnÄ› se mÅ¯Å¾e hodit interaktivnÄ› v notebooku mÄ›nit nÄ›jakÃ½ parametr (tÅ™eba hyperparametr pro strojovÃ© uÄenÃ­). Anebo chceme dÃ¡t vÃ½sledky naÅ¡Ã­ skvÄ›lÃ© analÃ½zy k dispozici "netechnickÃ½m" kolegÅ¯m nebo kamarÃ¡dÅ¯m, kteÅ™Ã­ (zatÃ­m) nedokÃ¡Å¾Ã­ Jupyter notebook spustit.</p>
<p>Tady si ukÃ¡Å¾eme, jak si s takovÃ½mi Ãºkoly poradit pomocÃ­ dvou nÃ¡strojÅ¯: <a href="https://plotly.com/python/">plotly</a>, resp. pÅ™edevÅ¡Ã­m <a href="https://plotly.com/python/plotly-express/">plotly express</a>, a <a href="https://panel.holoviz.org/">panel</a>.</p>
<p>ExistujÃ­ i dalÅ¡Ã­ nÃ¡stroje, kterÃ© poskytujÃ­ podobnÃ© moÅ¾nosti. PodrobnÃ½ pÅ™ehled najdete na <a href="https://pyviz.org/tools.html">https://pyviz.org/tools.html</a>.  Na interaktivnÃ­ vizualizace jsou to pÅ™edevÅ¡Ã­m <a href="http://github.com/pyviz/holoviews">holoviews</a> nebo <a href="http://github.com/altair-viz/altair">altair</a>. Na "dashboarding" pak <a href="http://github.com/plotly/dash">dash</a>, <a href="http://github.com/streamlit/streamlit">streamlit</a>, <a href="http://github.com/QuantStack/voila">voila</a> nebo <a href="https://justpy.io">justpy</a>.</p>
<p>KaÅ¾dÃ½ z tÄ›chto nÃ¡strojÅ¯ mÃ¡, jako obvykle, svÃ© vÃ½hody a nevÃ½hody. NejrozÅ¡Ã­Å™enÄ›jÅ¡Ã­m nÃ¡strojem je <a href="http://github.com/plotly/dash">Dash</a> ze stejnÃ© dÃ­lny jako plotly, kterÃ½ poskytuje i enterprise Å™eÅ¡enÃ­ pro provoz aplikacÃ­. Dash je urÄitÄ› dobrou volbou, jak se mÅ¯Å¾ete dozvÄ›dÄ›t i na <a href="https://www.youtube.com/watch?v=dewrzMPPLDU">pÅ™ednÃ¡Å¡ce z praÅ¾skÃ©ho PyData Meetupu</a>. Panel (a takÃ© Voila) se od Dash liÅ¡Ã­ tÃ­m, Å¾e je lze pouÅ¾Ã­t i v Jupytere notebooku a pak notebook pouÅ¾Ã­t pÅ™Ã­mo jako aplikaci - a proto Panel pouÅ¾ijeme my v tÃ©to lekci.</p>
<p>PÃ¡r ÄlÃ¡nkÅ¯ Äi pÅ™ednÃ¡Å¡ek, kterÃ© se tÃ©matu tÃ½kajÃ­:</p>
<ul>
<li><a href="https://www.intelligencerefinery.io/post/making-python-apps/">Going beyond Jupyter notebooks</a></li>
<li><a href="https://towardsdatascience.com/how-to-build-a-complex-reporting-dashboard-using-dash-and-plotl-4f4257c18a7f">How to Build a Reporting Dashboard using Dash and Plotly</a></li>
<li><a href="https://www.youtube.com/watch?v=L91rd1D6XTA">Turn any Notebook into a Deployable Dashboard | SciPy 2019 | James Bednar</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Pro a proti</h2>
<p>Je potÅ™eba ale Å™Ã­ct, Å¾e vÅ¡echny tyto pÅ™Ã­stupy majÃ­ svÃ© vÃ½raznÃ© nevÃ½hody a limity a nehodÃ­ se pro velkÃ© a sloÅ¾itÃ© aplikace. MoÅ¾nosti interakcÃ­ v aplikaci jsou omezenÃ© a takÃ© mohou bÃ½t pomalÃ©. RobustnÃ­ Å¡kÃ¡lovÃ¡nÃ­ pro mnoho uÅ¾ivatelÅ¯ (velkÃ½ provoz) je obecnÄ› sloÅ¾itÄ›jÅ¡Ã­. Kdy tedy pÅ™edevÅ¡Ã­m pouÅ¾Ã­t co si tady ukÃ¡Å¾eme?</p>
<ul>
<li>Na malou aplikaci pro omezenÃ½ poÄet uÅ¾ivatelÅ¯ (dashboard pro kolegy).</li>
<li>Na rychlÃ½ vÃ½voj prototypu.</li>
</ul>
<p>A co kdyÅ¾ chceme budovat velkou (webovou) aplikaci?</p>
<ul>
<li>ZadÃ¡me vÃ½vojÃ¡Å™skÃ©mu tÃ½mu, aby v modernÃ­ch JavaScript nÃ¡strojÃ­ch typu React nebo Vue.js pro nÃ¡s vytvoÅ™il krÃ¡snÃ½ a rychlÃ½ "front-end", zatÃ­mco my vytvoÅ™Ã­me v Pythonu "back-end", kterÃ½ s front-endem bude komunikovat napÅ™. pomocÃ­ JSON API, tak jak jsme vidÄ›li v <a href="/2020/pydata-ostrava-jaro/pydata/api/">naÅ¡Ã­ lekci o API</a>.</li>
<li>KdyÅ¾ takovÃ½ tÃ½m nemÃ¡me, nauÄÃ­me se programovat JavaScriptu ... Ne, radÄ›ji v TypeScriptu ...</li>
<li>... radÄ›ji najmeme ten vÃ½vojÃ¡Å™skÃ½ tÃ½m :-)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Instalace a import grafickÃ½ch knihoven</h2>
<p>Pokud nemÃ¡te nainstalovanÃ© knihovny plotly a panel, odkomentujte a spusÅ¥e pÅ™Ã­sluÅ¡nÃ© Å™Ã¡dky.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># instalace plotly</span>
<span class="c1"># %pip install plotly</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># instalace panel</span>
<span class="c1"># POZOR: nainstalujte tuto (v dobÄ› vzniku nejnovÄ›jÅ¡Ã­) verzi, </span>
<span class="c1"># s nÄ›kterÃ½mi pÅ™edeÅ¡lÃ½mi verzemi byl problÃ©m v nÃ¡slenÃ©m provozu na heroku</span>

<span class="c1"># %pip install bokeh==2.0.2 panel==0.9.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pro plotly express a panel se vÅ¾ily zkratky <code>px</code> a <code>pn</code>, pod kterÃ½mi je naimportujeme i my. 
DÃ¡le je pro pouÅ¾itÃ­ panelu v notebooku potÅ™eba zavolat <code>pn.extension</code>, v naÅ¡em pÅ™Ã­padÄ› s argumentem <code>"plotly"</code> aby tyto dvÄ› knihovny sprÃ¡vnÄ› spolupracovaly.
Je doporuÄenÃ© to udÄ›lat hned na zaÄÃ¡tku notebooku, resp. pÅ™ed pouÅ¾itÃ­m plotly nebo panel, jinak mÅ¯Å¾e dojÃ­t k problÃ©mÅ¯m v zobrazovÃ¡nÃ­ notebooku.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">panel</span> <span class="k">as</span> <span class="nn">pn</span>

<span class="n">pn</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"plotly"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>COVID-19 dashboard</h2>
<p>Z onemocnÄ›nÃ­ COVID-19 je v dobÄ› vzniku tohoto kurzu vÄ›tÅ¡ina z nÃ¡s uÅ¾ dost neÅ¡Å¥astnÃ¡. Poskytuje ale pÅ™Ã­leÅ¾itost k analÃ½zÃ¡m dat a vytvÃ¡Å™enÃ­ vizualizacÃ­ a dashboardÅ¯. Jejich pÅ™ehled a hodnocenÃ­ pÅ™inÃ¡Å¡Ã­ napÅ™. i ÄlÃ¡nek z MIT: <a href="https://www.technologyreview.com/2020/03/06/905436/best-worst-coronavirus-dashboards/">The best, and the worst, of the coronavirus dashboards</a>. UvidÃ­me, jestli se do pÅ™Ã­Å¡tÃ­ho vydÃ¡nÃ­ dostane a nÃ¡Å¡ dashboard :)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Data</h3>
<p>PouÅ¾ijeme data z <a href="https://github.com/datasets/covid-19">https://github.com/datasets/covid-19</a> (lehce pÅ™eformÃ¡tovanÃ¡ data z Johns Hopkins University: <a href="https://github.com/CSSEGISandData/COVID-19">https://github.com/CSSEGISandData/COVID-19</a>).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">covid_data_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">"https://raw.githubusercontent.com/datasets/covid-19/master/data/time-series-19-covid-combined.csv"</span><span class="p">,</span>
    <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s2">"Date"</span><span class="p">],</span>
<span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">"Province/State"</span><span class="p">:</span> <span class="s2">"State"</span><span class="p">,</span> <span class="s2">"Country/Region"</span><span class="p">:</span> <span class="s2">"Country"</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">covid_data_raw</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>Country</th>
      <th>State</th>
      <th>Lat</th>
      <th>Long</th>
      <th>Confirmed</th>
      <th>Recovered</th>
      <th>Deaths</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-22</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-23</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-24</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-25</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-26</td>
      <td>Afghanistan</td>
      <td>NaN</td>
      <td>33.0</td>
      <td>65.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>28989</th>
      <td>2020-05-05</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>28990</th>
      <td>2020-05-06</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>28991</th>
      <td>2020-05-07</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>28992</th>
      <td>2020-05-08</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>34.0</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>28993</th>
      <td>2020-05-09</td>
      <td>Zimbabwe</td>
      <td>NaN</td>
      <td>-20.0</td>
      <td>30.0</td>
      <td>35.0</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>28994 rows Ã— 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pro nÄ›kterÃ© zemÄ› je v datech vÃ­ce regionÅ¯. My si ale data agregujeme podle zemÃ­ dohromady.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">covid_data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">covid_data_raw</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">"Country"</span><span class="p">,</span> <span class="s2">"Date"</span><span class="p">])[[</span><span class="s2">"Confirmed"</span><span class="p">,</span> <span class="s2">"Recovered"</span><span class="p">,</span> <span class="s2">"Deaths"</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">"sum"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">covid_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Date</th>
      <th>Confirmed</th>
      <th>Recovered</th>
      <th>Deaths</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>2020-01-22</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>2020-01-23</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>2020-01-24</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>2020-01-25</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>2020-01-26</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>20378</th>
      <td>Zimbabwe</td>
      <td>2020-05-05</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>20379</th>
      <td>Zimbabwe</td>
      <td>2020-05-06</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>20380</th>
      <td>Zimbabwe</td>
      <td>2020-05-07</td>
      <td>34.0</td>
      <td>5.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>20381</th>
      <td>Zimbabwe</td>
      <td>2020-05-08</td>
      <td>34.0</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>20382</th>
      <td>Zimbabwe</td>
      <td>2020-05-09</td>
      <td>35.0</td>
      <td>9.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
<p>20383 rows Ã— 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>InteraktivnÃ­ vizualizace</h3>
<p>ZajÃ­mÃ¡ nÃ¡s prÅ¯bÄ›h jednÃ© konkrÃ©tnÃ­ zemÄ› - tÅ™eba ÄŒeska :)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># uloÅ¾Ã­me si to do promÄ›nnÃ©, abychom to pak nespletli</span>
<span class="n">country</span> <span class="o">=</span> <span class="s2">"Czechia"</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">covid_selected_country</span> <span class="o">=</span> <span class="n">covid_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">f</span><span class="s1">'Country == "</span><span class="si">{country}</span><span class="s1">"'</span><span class="p">)</span>
<span class="n">covid_selected_country</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Country</th>
      <th>Date</th>
      <th>Confirmed</th>
      <th>Recovered</th>
      <th>Deaths</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5118</th>
      <td>Czechia</td>
      <td>2020-05-05</td>
      <td>7896.0</td>
      <td>4006.0</td>
      <td>257.0</td>
    </tr>
    <tr>
      <th>5119</th>
      <td>Czechia</td>
      <td>2020-05-06</td>
      <td>7974.0</td>
      <td>4205.0</td>
      <td>262.0</td>
    </tr>
    <tr>
      <th>5120</th>
      <td>Czechia</td>
      <td>2020-05-07</td>
      <td>8031.0</td>
      <td>4371.0</td>
      <td>270.0</td>
    </tr>
    <tr>
      <th>5121</th>
      <td>Czechia</td>
      <td>2020-05-08</td>
      <td>8077.0</td>
      <td>4413.0</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>5122</th>
      <td>Czechia</td>
      <td>2020-05-09</td>
      <td>8095.0</td>
      <td>4447.0</td>
      <td>276.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>UrÄitÄ› bude zajÃ­mavÃ© si data vykreslit v grafu. ZatÃ­m jsme pouÅ¾Ã­vali hlavnÄ› knihovnu <code>matplotlib</code>. Ta toho umÃ­ opravdu hodnÄ›, navÃ­c jde pouÅ¾Ã­vat pÅ™Ã­mo pomocÃ­ <code>DataFrame.plot</code>. ChybÃ­ jÃ­ ale vlastnost, kterÃ¡ je pro datovou analÃ½zu a hlavnÄ› pak pro webovÃ© aplikace nesmÃ­rnÄ› uÅ¾iteÄnÃ¡: <em>interaktivita</em>. (Ona tedy nechybÃ­ ÃºplnÄ›, ale je velmi omezenÃ¡.)</p>
<p>Interaktivita nÃ¡m umoÅ¾Åˆuje bohatÅ¡Ã­ prÃ¡ci s vizualizacemi. MÅ¯Å¾eme si zvÄ›tÅ¡it nÄ›jakou podoblast grafu. MÅ¯Å¾eme zvÄ›tÅ¡ovat / zmenÅ¡ovat mÄ›Å™Ã­tko aby byly vidÄ›t tÅ™eba i malÃ© rozdÃ­ly v hodnotÃ¡ch. V <a href="/2020/pydata-ostrava-jaro/pydata/pca/">lekci a PCA</a> jsme pouÅ¾ili interakticnÃ­ popisky jednotlivÃ½ch symbolÅ¯ v grafu na identifikaci pÅ™Ã­sluÅ¡nÃ©ho zÃ¡znamu v datech. A mnoho dalÅ¡Ã­ho.</p>
<p>S <a href="https://plot.ly">plotly</a>, resp. <a href="https://plotly.com/python/plotly-express/">plotly-express</a>, uÅ¾ jsme trochu pracovali. PojÄme tedy tuto knihovnu rovnou pouÅ¾Ã­t!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">covid_selected_country</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Confirmed"</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">f</span><span class="s2">"Confirmed cases in </span><span class="si">{country}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TeÄ byste mÄ›li v notebooku vidÄ›t graf - vÃ½voj pÅ™Ã­padÅ¯ v ÄŒesku. PojÄme si s grafem chvilku hrÃ¡t :)</p>
<p><strong>VyzkouÅ¡ejte:</strong></p>
<ul>
<li>Vybrat a vyzkouÅ¡et nÃ¡stroje v pravÃ©m hornÃ­m rohu na zoom (zmÄ›nu mÄ›Å™Ã­tka), pan (posun) nebo reset axis.</li>
<li>Zkuste se zastavit s kurzorem nad jednÃ­m ze slopcÅ¯ v grafu.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Ãškol:</strong></p>
<ol>
<li>Vykreslete prÅ¯bÄ›h poÄtu nakaÅ¾enÃ½ch pro ÄŒesko, Rakousko a Finsko v jednom grafu, kaÅ¾dou zemi jinou barvou (pouÅ¾ijte argument <code>color</code>). Na filtrovÃ¡nÃ­ dat si vzpomeÅˆte na <code>.isin</code>. </li>
<li>ZmÄ›Åˆte veliÄinu na poÄet uzdravenÃ½ch.</li>
<li>ZmÄ›Åˆte typ grafu na ÄÃ¡rovÃ½ (line).</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>DokÃ¡zali jsme si vytvoÅ™it celkem pÄ›knou vizualizaci zÃ¡kladnÃ­ch veliÄin, popisujÃ­ch prÅ¯bÄ›h pandemie COVID-19. Museli jsme si ale ruÄnÄ› vybÃ­rat a pÅ™epÃ­nat parametry vizualizace, napÅ™. vÃ½bÄ›r zemÃ­ nebo vykreslovanÃ© veliÄiny.</p>
<p>PraktiÄtÄ›jÅ¡Ã­ by urÄitÄ› bylo mÃ­t nÄ›jakÃ© "klikÃ¡tko" - "vybÃ­rÃ¡vÃ¡tko", kterÃ© by nÃ¡m parametry umoÅ¾nilo nastavit.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Widgets - pomocnÃ© "vÄ›ciÄky"</h3>
<p>V uÅ¾ivatelskÃ½ch grafickÃ½ch rozhranÃ­ch (GUI), zejmÃ©na tÄ›ch pouÅ¾Ã­vajÃ­cÃ­ch webovÃ© technologie, se prÃ¡vÄ› pro tyto pÅ™ileÅ¾itosti hodÃ­ <em>widgety</em> (ÄeskÃ½ vÃ½raz se nepouÅ¾Ã­vÃ¡ a ani poÅ™Ã¡dnÄ› neexistuje).</p>
<p>A jelikoÅ¾ mÃ¡me to Å¡tÄ›stÃ­, Å¾e notebook mÃ¡ webovÃ© grafickÃ© rozhranÃ­, mÅ¯Å¾eme widgety pÅ™idat pÅ™Ã­mo do nÄ›j. Jednou z moÅ¾nostÃ­ je pouÅ¾Ã­t knihovnu <a href="https://panel.pyviz.org">panel</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>VytvoÅ™Ã­me si rovnou ÃºplnÄ› jednoduchÃ½ widget na vÃ½bÄ›r zÄ›mÄ›:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">country_selection</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">covid_data</span><span class="p">[</span><span class="s2">"Country"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="n">name</span><span class="o">=</span><span class="s2">"Country"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A teÄ si ho zobrazÃ­me pÅ™Ã­ho v notebooku:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">country_selection</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V tuto chvÃ­li mÅ¯Å¾ete vybÃ­rat se zeznamu vÅ¡ech zemÃ­, kterÃ© jsou v naÅ¡ich datech. To je pohled vÃ¡s jako uÅ¾ivatele. Ale co se stane z pohledu programÃ¡tora, tedy co se stane v Pythonu?</p>
<p>Objekt <code>country_selection</code> nÃ¡m nabÃ­zÃ­ nÄ›kolik atributÅ¯ a metod, kterÃ© nÃ¡m umoÅ¾ÅˆujÃ­ zjistit, co uÅ¾ivatel udÄ›lal. V tomto pÅ™Ã­padÄ› se nejvÃ­c hodÃ­ zjistit, jakou zemi uÅ¾ivatel vybral. A na to je <code>.value</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">country_selection</span><span class="o">.</span><span class="n">value</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>'Afghanistan'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Ãškol:</strong> Vyberte v buÅˆce nahoÅ™e svou (ne)oblÃ­benou zemi a podÃ­vejte se, jestli se zmÄ›nila hodnota <code>country_selection.value</code>. Je potÅ™eba spouÅ¡tÄ› znovu buÅˆku, kterÃ¡ zobrazuje <code>country_selection</code> widget? Co se stane, kdyÅ¾ jÃ­ spustÃ­te znovu (tÅ™eba v jinÃ© buÅˆce)?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>country_selection.value</code> uÅ¾ je nÄ›co, co mÅ¯Å¾eme pouÅ¾Ã­t pro vykreslenÃ­ grafu podobnÄ› jako pÅ™ed chvilkou:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">covid_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">f</span><span class="s1">'Country == "</span><span class="si">{country_selection.value}</span><span class="s1">"'</span><span class="p">),</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">"Confirmed"</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="n">f</span><span class="s2">"Confirmed cases in </span><span class="si">{country_selection.value}</span><span class="s2">"</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TeÄ jsme mohli vybrat jeden parametr. Hodilo by se nÃ¡m ale vybÃ­rat vÃ­ce parametrÅ¯ rÅ¯znÃ½ch typÅ¯: vÃ½bÄ›r vÃ­ce zemÃ­, vykreslenÃ¡ veliÄina, pÅ™epÃ­naÄ logaritmickÃ© Å¡kÃ¡ly nebo tÅ™eba typ zobrazenÃ­ (bar nebo line plot). S volbou vhodnÃ½ch widgetÅ¯ nÃ¡m pomÅ¯Å¾e <a href="https://panel.holoviz.org/reference/index.html">dokumentace panel</a> (pozor, nÄ›kterÃ© widgety nejsou v naÅ¡Ã­ starÅ¡Ã­ verzi dostupnÃ©). Abychom nemuseli kaÅ¾dÃ½ widget zobrazovat zvlÃ¡Å¡Å¥, pouÅ¾ijeme komponenty z kategorie Layouts, nynÃ­ konkrÃ©tnÄ› <code>Column</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># widget pro vÃ½bÄ›r vÃ­ce moÅ¾nostÃ­ ze seznamu</span>
<span class="n">countries_selection</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">CrossSelector</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">"Countries"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">covid_data</span><span class="p">[</span><span class="s2">"Country"</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="s2">"Czechia"</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1"># vÃ½bÄ›r vykreslenÃ© veliÄiny</span>
<span class="n">plotted_variable</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">"Plotted variable"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[</span><span class="s2">"Confirmed"</span><span class="p">,</span> <span class="s2">"Recovered"</span><span class="p">,</span> <span class="s2">"Deaths"</span><span class="p">]</span>
<span class="p">)</span>
<span class="c1"># pÅ™epÃ­naÄ logaritmickÃ© Å¡kÃ¡ly</span>
<span class="n">use_log_scale</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Checkbox</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">"Use log scale"</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># vÃ½bÄ›r typu grafu</span>
<span class="n">plot_type</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">widgets</span><span class="o">.</span><span class="n">Select</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">"Plot type"</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">"bar"</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">,</span> <span class="s2">"line"</span><span class="p">:</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A teÄ to dÃ¡me vÅ¡e dohromady pro zobrazenÃ­ nad sebou, tj. do sloupce, a rovnou zobrazÃ­me.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selections</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">countries_selection</span><span class="p">,</span> <span class="n">plotted_variable</span><span class="p">,</span> <span class="n">use_log_scale</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>

<span class="n">selections</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pokud chceme dÃ¡t dvÄ› komponenty vedle sebe, dÃ¡me je do jednÃ© Å™ady nebo <code>Row</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">selections</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span>
    <span class="n">countries_selection</span><span class="p">,</span> <span class="n">pn</span><span class="o">.</span><span class="n">Row</span><span class="p">(</span><span class="n">plotted_variable</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">),</span> <span class="n">use_log_scale</span>
<span class="p">)</span>

<span class="n">selections</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A teÄ uÅ¾ mÅ¯Å¾eme vybranÃ© moÅ¾nosti pouÅ¾Ã­t:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_type</span><span class="o">.</span><span class="n">value</span><span class="p">(</span>
    <span class="n">covid_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">covid_data</span><span class="p">[</span><span class="s2">"Country"</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries_selection</span><span class="o">.</span><span class="n">value</span><span class="p">)],</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">plotted_variable</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">"Country"</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="n">use_log_scale</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>ProvÃ¡zÃ¡nÃ­ uÅ¾ivatelskÃ½ch vstupÅ¯ a vÃ½stupu</h3>
<p>NaÅ¡Ã­ aplikaci teÄ chybÃ­ uÅ¾ jen "maliÄkost" - provÃ¡zat uÅ¾ivatelskÃ© vstupy s vÃ½stupem tak, aby se vÃ½stup automaticky aktualizoval. 
Aby se nÃ¡m to podaÅ™ilo, budeme muset nÃ¡Å¡ kÃ³d zabalit do funkce, kterÃ¡ aplikaci (dashboard) vytvÃ¡Å™Ã­.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># argumenty funkce NEJSOU widgety</span>
<span class="k">def</span> <span class="nf">create_dashboard</span><span class="p">(</span><span class="n">countries</span><span class="p">,</span> <span class="n">plot_variable</span><span class="p">,</span> <span class="n">plot_function</span><span class="p">,</span> <span class="n">log_y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">plot_type</span><span class="o">.</span><span class="n">value</span><span class="p">(</span>
        <span class="n">covid_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">covid_data</span><span class="p">[</span><span class="s2">"Country"</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">countries</span><span class="p">)],</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">"Date"</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">plot_variable</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">"Country"</span><span class="p">,</span>
        <span class="n">log_y</span><span class="o">=</span><span class="n">log_y</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Funkci mÅ¯Å¾eme vyzkouÅ¡et a pÅ™edat jÃ­ aktuÃ¡lnÃ­ hodnoty z widgetÅ¯. TÃ­m ale stÃ¡le jeÅ¡tÄ› <em>nemÃ¡me interaktivnÃ­ aplikaci</em>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">create_dashboard</span><span class="p">(</span>
    <span class="n">countries</span><span class="o">=</span><span class="n">countries_selection</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">plot_variable</span><span class="o">=</span><span class="n">plotted_variable</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">plot_function</span><span class="o">=</span><span class="n">plot_type</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="n">use_log_scale</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TÃ­m zbÃ½vajÃ­cÃ­m kouskem sklÃ¡daÄky k interaktivnÃ­ aplikaci je funkce <code>interact</code>. Ta nÃ¡m "obalÃ­" naÅ¡i funkci, v tomto pÅ™Ã­padÄ› <code>create_dashboard</code>, a svÃ¡Å¾e hodnoty widgetÅ¯ se vstupnÃ­mi argumenty naÅ¡Ã­ funkce (kterÃ¡ generuje grafickÃ½ vÃ½stup na zÃ¡kladÄ› hodnot vstupnÃ­ch parametrÅ¯).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># nejprve interaktivnÃ­ dashboard vytvoÅ™Ã­me</span>
<span class="n">interactive_dashboard</span> <span class="o">=</span> <span class="n">pn</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
    <span class="n">create_dashboard</span><span class="p">,</span>
    <span class="n">countries</span><span class="o">=</span><span class="n">countries_selection</span><span class="p">,</span>
    <span class="n">plot_variable</span><span class="o">=</span><span class="n">plotted_variable</span><span class="p">,</span>
    <span class="n">plot_function</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span>
    <span class="n">log_y</span><span class="o">=</span><span class="n">use_log_scale</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># a potÃ© zobrazÃ­me</span>
<span class="n">interactive_dashboard</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>TeÄ si zkuste mÄ›nit hodnoty pomocÃ­ widgetÅ¯ - vÃ½stup se bude hned mÄ›nit (tedy skoro hned - takto vytvoÅ™enÃ¡ aplikace nenÃ­ nejsviÅ¾nÄ›jÅ¡Ã­ - to je drobÃ¡ daÅˆ za jednoduchust implementace).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2>Z notebooku k samostatnÃ© aplikaci</h2>
<p>ZatÃ­m jsi si vÅ¡e zprovoznil(a) ve svÃ©m notebooku. To je vÃ½bornÃ©, ale mÃ¡ to poÅ™Ã¡d jeÅ¡tÄ› drobnou nevÃ½hodu - poslat takovÃ½ notebook nÄ›komu, kdo si pod pojmem Python vybavÃ­ pouze ğŸ, je riskantnÃ­. KdyÅ¾ totiÅ¾ jako nÃ¡povÄ›du uslyÅ¡Ã­, Å¾e si toho hada mÃ¡ pustit, nejspÃ­Å¡ se lekne a uteÄe. MÃ­sto toho bychom radÄ›ji pÅ™edali jen odkaz na webovou "strÃ¡nku", tedy na nÃ¡Å¡ dashboard.</p>
<p>ZaÄneme tÃ­m, Å¾e si aplikaci spustÃ­me na svÃ©m poÄÃ­taÄi. To jde naÅ¡tÄ›stÃ­ velice jednoduÅ¡e, dokonce mÅ¯Å¾eme pouÅ¾Ã­t pÅ™Ã­mo tento notebook. Jen musÃ­me nÄ›jak vysvÄ›tlit, co pÅ™esnÄ› v tÃ© aplikaci mÃ¡ bÃ½t. Na to slouÅ¾Ã­ metoda <code>servable</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [Â ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interactive_dashboard</span><span class="o">.</span><span class="n">servable</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"MÅ¯j COVID-19 dashboard"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V notebooku se nic nezmÄ›nilo, mÅ¯Å¾eme ale spustit notebook jako samostatnou aplikaci. V pÅ™Ã­kazovÃ© Å™Ã¡dce to zajistÃ­</p>
<div class="highlight"><pre><code>bokeh serve dashboards.ipynb</code></pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ZobrazÃ­ se nÃ¡m nÄ›co jako</p>
<div class="highlight"><pre><code>2020-04-13 09:31:13,787 Starting Bokeh server version 1.4.0 (running on Tornado 6.0.4)
2020-04-13 09:31:13,799 User authentication hooks NOT provided (default user enabled)
2020-04-13 09:31:13,802 Bokeh app running at: http://localhost:5006/dashboards
2020-04-13 09:31:13,802 Starting Bokeh server with process id: 9220</code></pre></div><p>Na tÅ™etÃ­m Å™Ã¡dku jistÄ› rozeznÃ¡te webovÃ½ odkaz. PravdÄ›podobnÄ› tam bude <a href="http://localhost:5006/dashboards">http://localhost:5006/dashboards</a>. Pokud tuto adresu otevÅ™eÅ¡ v prohlÃ­Å¾eÄi, zobrazÃ­ se poslednÃ­ verze naÅ¡eho COVID dashboardu - ta, u kterÃ© jsme zavolal metodu <code>.servable()</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Publikujeme na internet</h3>
<p>V principu bychom mohli spustit aplikaci u sebe na poÄÃ­taÄi tak, aby ji mohli pouÅ¾Ã­vat i dalÅ¡Ã­ uÅ¾ivatelÃ©. Na vnitÅ™nÃ­ sÃ­ti (domÃ¡cÃ­, pracovnÃ­) by to bylo snadnÃ© (i kdyÅ¾ na pracovnÃ­ sÃ­ti a pracovnÃ­m poÄÃ­taÄi by tomu mohla brÃ¡nit bezpeÄnostnÃ­ nastavenÃ­), pÅ™Ã­stup z vnÄ›jÅ¡Ã­ho internetu by uÅ¾ byl komplikovanÄ›jÅ¡Ã­.</p>
<p>NaÅ¡tÄ›stÃ­ nejsme v podobnÃ© situaci sami :) TakÅ¾e existujÃ­ vÃ­ce Äi mÃ©nÄ› sloÅ¾itÃ© a sofistikovanÃ© zpÅ¯soby, jak aplikaci spustit na nÄ›jakÃ©m serveru (v cloudu) a zpÅ™Ã­stupnit z internetu. My si ukÃ¡Å¾eme, jak to funguje na <a href="https://heroku.com">Heroku</a>. PodobnÃ© sluÅ¾by nabÃ­zÃ­ tÅ™eba AWS (Elastic Beanstalk), Google App Engine nebo Dokku on Digital Ocean. VÃ½hodou Heroku je jednoduchost a moÅ¾nost bezplatnÃ½ch sluÅ¾eb, nevÃ½hodou pak rychle rostoucÃ­ cena a omezenÃ© moÅ¾nosti.</p>
<p>Budeme postupovat v podstatÄ› podle prÅ¯vodce <a href="https://devcenter.heroku.com/articles/getting-started-with-python">Getting started with Python</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Registrace a klient Heroku</h3>
<p>NeÅ¾ zaÄneme, je potÅ™eba:</p>
<ol>
<li>ZaloÅ¾it si bezplatnÃ½ ÃºÄet na <a href="https://signup.heroku.com/signup/dc">https://signup.heroku.com/signup/dc</a>.</li>
<li>Nainstalovat Git:<ul>
<li>Windows: <a href="https://gitforwindows.org/">https://gitforwindows.org/</a></li>
<li>Mac OS: <a href="https://sourceforge.net/projects/git-osx-installer/files/">https://sourceforge.net/projects/git-osx-installer/files/</a> (pÅ™Ã­padnÄ› dalÅ¡Ã­ moÅ¾nosti popsanÃ© na <a href="https://www.atlassian.com/git/tutorials/install-git">https://www.atlassian.com/git/tutorials/install-git</a>).</li>
<li>Linux: NejspÃ­Å¡ tam uÅ¾ bude nebo urÄitÄ› vÃ­Å¡ jak na to :)</li>
</ul>
</li>
<li>AlespoÅˆ zÃ¡kladnÃ­ konfigurace Gitu. V pÅ™Ã­kazovÃ©m Å™Ã¡dku (<em>vyplÅˆte svÃ© jmÃ©no a email</em>):<div class="highlight"><pre><code>git config --global user.name "Moje JmÃ©no"
git config --global user.email "muj@email.com"</code></pre></div></li>
<li>Nainstalovat si Heroku klienta:<ul>
<li>Postupujte podle <a href="https://devcenter.heroku.com/articles/heroku-cli">https://devcenter.heroku.com/articles/heroku-cli</a></li>
</ul>
</li>
</ol>
<p>Instalaci ovÄ›Å™Ã­me v pÅ™Ã­kazovÃ© Å™Ã¡dce pomocÃ­:</p>
<ol>
<li><p>Git:</p>
<div class="highlight"><pre><code>git config --list</code></pre></div><p>MÄ›lo by se objevit nÄ›co na zpÅ¯sob</p>
<div class="highlight"><pre><code>user.name=Moje JmÃ©no
user.email=muj@email.com</code></pre></div></li>
<li><p>Heroku:</p>
<div class="highlight"><pre><code>heroku --version</code></pre></div><p>Tady by mÄ›lo bÃ½t vÃ½stupem zhruba</p>
<div class="highlight"><pre><code>heroku/7.39.2 darwin-x64 node-v12.13.0</code></pre></div></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3>Go-live</h3>
<p>TeÄ budeme chvilku pracovat v pÅ™Ã­kazovÃ© Å™Ã¡dce. NeÅ¾ zaÄnete psÃ¡t pÅ™Ã­kazy, ujistÄ›te se, Å¾e jste ve sloÅ¾ce s tÃ­mto netebookem. IdeÃ¡lnÄ› by v tÃ©to sloÅ¾ce mÄ›l bÃ½t (zatÃ­m) jen tento notebook. Pokud to tak nenÃ­, mÅ¯Å¾ete si vytvoÅ™it sloÅ¾ku novou a notebook tam pÅ™esunout nebo zkopÃ­rovat.</p>
<p>A mÅ¯Å¾eme zaÄÃ­t:</p>
<ol>
<li><p>MusÃ­me vytvoÅ™it Git repozitÃ¡Å™:</p>
<div class="highlight"><pre><code>git init</code></pre></div></li>
<li><p>Pro Heroku potÅ™ebuje vytvoÅ™it soubor s nÃ¡zvem <code>Procfile</code>. Ten velice jednoduÅ¡e Å™Ã­kÃ¡, co Å¾e to vlastnÄ› chceme spustit. Bude tam pÅ™Ã­kaz <code>bokeh serve</code> (tak jako jsme spouÅ¡tÄ›li aplikaci lokÃ¡lnÄ›) s pÃ¡r pÅ™epÃ­naÄi navÃ­c. KonkrÃ©tnÄ› soubor <code>Procfile</code> musÃ­ obsahovat tento Å™Ã¡dek:</p>
<div class="highlight"><pre><code>web: bokeh serve --port=$PORT --allow-websocket-origin="*" --address=0.0.0.0 dashboards.ipynb</code></pre></div></li>
<li><p>DalÅ¡Ã­m souborem, kterÃ½ potÅ™ebujeme, je <code>requirements.txt</code>. O tom jste uÅ¾ moÅ¾nÃ¡ slyÅ¡eli(y) - obsahuje seznam Python balÃ­ÄkÅ¯, kterÃ© potÅ™ebuje danÃ½ Python projekt. Heroku tento soubor pouÅ¾ije, aby pÅ™ed spuÅ¡tÄ›nÃ­m aplikace nainstaloval vÅ¡e potÅ™ebnÃ©. Pro nÃ¡Å¡ dashboard musÃ­ bÃ½v v <code>requirements.txt</code> toto:</p>
<div class="highlight"><pre><code>bokeh==2.0.2
panel==0.9.5
pandas==1.0.3
notebook==6.0.3
plotly==4.5.4</code></pre></div></li>
<li><p>Soubory uÅ¾ mÃ¡me pÅ™ipravenÃ©, potÅ™ebujeme je teÄ pÅ™idat do Git repozitÃ¡Å™e. Na to pouÅ¾ij tyto dva pÅ™Ã­kazy:</p>
<div class="highlight"><pre><code>git add dashboards.ipynb Procfile requirements.txt
git commit -v -m "prvnÃ­ verze dashboardu"</code></pre></div></li>
<li><p>A teÄ uÅ¾ mÅ¯Å¾eme publikovat. Tedy nejdÅ™Ã­ve se pÅ™ihlÃ¡sit pomocÃ­</p>
<div class="highlight"><pre><code>heroku login</code></pre></div><p>(Postupujte dle pokynÅ¯ - otevÅ™e se pÅ™ihlaÅ¡ovacÃ­ strÃ¡nka ve webovÃ©m prohlÃ­Å¾eÄi, kterÃ¡ vÃ¡s vyzve k zadÃ¡nÃ­ pÅ™ihlaÅ¡ovacÃ­ch ÃºdajÅ¯.)</p>
</li>
<li><p>Pak jeÅ¡tÄ› vytvoÅ™it Heroku aplikaci pomocÃ­</p>
<div class="highlight"><pre><code>heroku create</code></pre></div></li>
<li><p>A nakonec uÅ¾ opravdu vypustit aplikaci na internet pomocÃ­</p>
<div class="highlight"><pre><code>git push heroku master</code></pre></div></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pokud vÅ¡e pÅ¯jde dobÅ™e, tento krok bude chvÃ­li trvat. PostupnÄ› se bude vypisovat, co pro nÃ¡s Heroku dÄ›lÃ¡:</p>
<div class="highlight"><pre><code>Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 4 threads
Compressing objects: 100% (4/4), done.
Writing objects: 100% (4/4), 940.72 KiB | 2.40 MiB/s, done.
Total 4 (delta 2), reused 0 (delta 0)
remote: Compressing source files... done.
remote: Building source:
remote:
remote: -----&gt; Python app detected
remote: -----&gt; Clearing cached dependencies
remote: -----&gt; Installing python-3.8.2
remote: -----&gt; Installing pip
remote: -----&gt; Installing SQLite3
remote: Sqlite3 successfully installed.
remote: -----&gt; Installing requirements with pip
remote:        Collecting bokeh==1.4.0
remote:          Downloading bokeh-1.4.0.tar.gz (32.4 MB)
remote:        Collecting panel==0.8.3
...</code></pre></div><p>Nakonec by se mÄ›lo objevit nÄ›co jako</p>
<div class="highlight"><pre><code>remote: -----&gt; Launching...
remote:        Released v20
remote:        https://banana-sundae-72768.herokuapp.com/ deployed to Heroku
remote:
remote: Verifying deploy... done.
To https://git.heroku.com/banana-sundae-72768.git
   2652f01..8d65612  master -&gt; master</code></pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>DÅ¯leÅ¾itÃ½ je odkaz pod Å™Ã¡dkem "Released v20". To je totiÅ¾ adresa, na kterÃ© je nÃ¡Å¡ dashboard dostupnÃ½ "odkudkoli z internetu". BuÄ si ji zkopÃ­rujte do prohlÃ­Å¾eÄe nebo pouÅ¾ijte pÅ™Ã­kaz <code>heroku open</code>.</p>
</div>
</div>
</div>
 




        </div>

        
        <hr class="lesson-end">

        
            <div class="alert alert-info">
                Toto je strÃ¡nka lekce z kurzu, kterÃ½ probÃ­hÃ¡ nebo probÄ›hl naÅ¾ivo s instruktorem.
                
            </div>
        


        
    <div class="row prev-next">
        
            
            
                
    <div class="col text-left">
        <a href="/2020/pydata-ostrava-jaro/sessions/dashboards/">â†‘Â <span class="d-none d-sm-inline">Lekce: InteraktivnÃ­ vizualizace a aplikace</span></a>
    </div>

            
            
                
    <div class="col text-right">
        <a href="/2020/pydata-ostrava-jaro/pydata/dashboards-2/"><span class="d-none d-sm-inline">InteraktivnÃ­ vizualizace a aplikace II.</span>Â â†’</a>
    </div>

            
        
    </div>


        

    </div>
</div>



        <script type="text/javascript" src="/static/js/solutions.js"></script>

        <div class="footer container">
            <hr>
            <div class="lesson-attribution">
                
                    <p>
                        Uprav tuto strÃ¡nku na
                        <a href="https://github.com/pyvec/naucse.python.cz/blob/archive/2020-pydata-ostrava-jaro/lessons/pydata/dashboards/index.ipynb">
                            
                                <svg class="icon icon-github" viewBox="0 0 64 64">
<path d="M32 0 C14 0 0 14 0 32 0 53 19 62 22 62 24 62 24 61 24 60 L24 55 C17 57 14 53 13 50 13 50 13 49 11 47 10 46 6 44 10 44 13 44 15 48 15 48 18 52 22 51 24 50 24 48 26 46 26 46 18 45 12 42 12 31 12 27 13 24 15 22 15 22 13 18 15 13 15 13 20 13 24 17 27 15 37 15 40 17 44 13 49 13 49 13 51 20 49 22 49 22 51 24 52 27 52 31 52 42 45 45 38 46 39 47 40 49 40 52 L40 60 C40 61 40 62 42 62 45 62 64 53 64 32 64 14 50 0 32 0 Z" fill="currentColor" stroke-width="0"/>
</svg>
                            
                          GitHubu
                        </a>
                    </p>
                

                
    
        <p>Pro PyDataCZ napsal Jakub Urban, 2020.</p>
    

                
    <p>
        Licence:
        <a href="https://creativecommons.org/licenses/by-sa/4.0/">
            Creative Commons Attribution-ShareAlike 4.0 International
        </a>
    </p>
    

                
            </div>
        </div>

        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>

        

    </body>
</html>