
<!doctype html>
<html lang="cs">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>
            
                DatovÃ½ kurz PyLadies: Pandas - spojovÃ¡nÃ­ tabulek
            
        </title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">

        

        <link rel="stylesheet" href="/static/css/naucse.css">
        <link rel="stylesheet" href="/static/css/body.css">
        <link rel="stylesheet" href="/static/css/pygments-lovelace-style.css">
        <link rel="stylesheet" href="/static/css/ipython.css">

        
    


        <style>
            
    

        </style>
    </head>

    <body>
        <nav class="header">
            <ul class="container menu">
                <li><a href="/" class="logo"><h1>NauÄ se Python!</h1></a></li>
                <li><a href="/courses/" class="menu-link"><h2>MateriÃ¡ly</h2></a></li>
                <li><a href="/runs/" class="menu-link"><h2>Kurzy</h2></a></li>
            </ul>
        </nav>

        

<div class="page">
    <div class="container">

        
            <header class="lesson-header">
                <a href="/">NauÄ se Python </a>
                
                > <a href="/runs/">Kurzy</a>
                
                

> <a href="/2024/pydata-praha-podzim/">DatovÃ½ kurz PyLadies</a>

> <a href="/2024/pydata-praha-podzim/sessions/eda4/">ExplorativnÃ­ datovÃ¡ analÃ½za a vÃ­ce zdrojÅ¯ / promÄ›nnÃ½ch</a>

> <a href="/2024/pydata-praha-podzim/pydata/pandas_joins/">Pandas - spojovÃ¡nÃ­ tabulek</a>


                <hr>
            </header>
        

        
  


        <div class="lesson-content">
          
    

    <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="pandas_-_spojovani_tabulek">Pandas - spojovÃ¡nÃ­ tabulek
<a class="header-link" href="#pandas_-_spojovani_tabulek">#</a>
</h1>
<p>Tato lekce se nese ve znamenÃ­ mnohosti a propojovÃ¡nÃ­ - nauÄÃ­Å¡ se  pracovat s vÃ­ce tabulkami najednou. PÅ™i tom spoleÄnÄ› projdeme (ne poprvÃ© a ne naposledy) ÄiÅ¡tÄ›nÃ­ reÃ¡lnÃ½ch datovÃ½ch sad.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Importy jako obvykle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="spojovani_tabulek">SpojovÃ¡nÃ­ tabulek
<a class="header-link" href="#spojovani_tabulek">#</a>
</h2>
<p>V lekci, kde jsme zpracovÃ¡vali data o poÄasÃ­, jsme ti ukÃ¡zali, Å¾e je pomocÃ­ funkce <code>concat</code> moÅ¾nÃ© slepit dohromady nÄ›kolik objektÅ¯ <code>DataFrame</code> Äi <code>Series</code>, pokud majÃ­ "kompatibilnÃ­" index. NynÃ­ se na problematiku podÃ­vÃ¡me trochu blÃ­Å¾e a ukÃ¡Å¾eme si, jak spojovat tabulky na zÃ¡kladÄ› rÅ¯znÃ½ch sloupcÅ¯, a co dÄ›lat, kdyÅ¾ Å™Ã¡dky z jednÃ© tabulky nepasujÃ­ pÅ™esnÄ› na tabulku druhou.</p>
<p>ObecnÄ› pro spojovÃ¡nÃ­ <code>pandas</code> nabÃ­zÃ­ tÅ™i funkce / metody, z nichÅ¾ kaÅ¾dÃ¡ mÃ¡ svoje typickÃ© vyuÅ¾itÃ­ (moÅ¾nostmi se ovÅ¡em pÅ™ekrÃ½vajÃ­):</p>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html"><code>concat</code></a> je univerzÃ¡lnÃ­ funkce pro slepovÃ¡nÃ­ dvou Äi vÃ­ce tabulek / sloupcÅ¯ - pod sebe, vedle sebe, s pÅ™ihlÃ©dnutÃ­m k indexÅ¯m i bez nÄ›j.</li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.merge.html"><code>merge</code></a> je univerzÃ¡lnÃ­ funkce pro spojovÃ¡nÃ­ tabulek na zÃ¡kladÄ› vazby mezi indexy nebo sloupci.</li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html"><code>join</code></a> (metoda) zjednoduÅ¡uje prÃ¡ci, kdyÅ¾ chceÅ¡ spojit dvÄ› tabulky na zÃ¡kladÄ› indexu.</li>
</ul>
<p>DetailnÃ­ rozbor toho, co kterÃ¡ umÃ­, najdeÅ¡ v <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html">dokumentaci</a>. My si je takÃ© postupnÄ› ukÃ¡Å¾eme.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="jednoduche_skladani">JednoduchÃ© sklÃ¡dÃ¡nÃ­
<a class="header-link" href="#jednoduche_skladani">#</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="pod_sebou">Pod sebou
<a class="header-link" href="#pod_sebou">#</a>
</h4>
<p>To je asi ten nejjednoduÅ¡Å¡Ã­ pÅ™Ã­pad - mÃ¡me dva objekty <code>Series</code> nebo dva kusy tabulky se stejnÃ½mi sloupci a chceme je spojit pod sebou. Na to se pouÅ¾Ã­vÃ¡ funkce <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html"><code>concat</code></a>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">"jedna"</span><span class="p">,</span> <span class="s2">"dvÄ›"</span><span class="p">,</span> <span class="s2">"tÅ™i"</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">"ÄtyÅ™i"</span><span class="p">,</span> <span class="s2">"pÄ›t"</span><span class="p">,</span> <span class="s2">"Å¡est"</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0    jedna
1      dvÄ›
2      tÅ™i
0    ÄtyÅ™i
1      pÄ›t
2     Å¡est
dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ğŸ’¡ VidÃ­Å¡, Å¾e se index opakuje? VytvoÅ™ili jsme dvÄ› <code>Series</code>, u kterÃ½ch jsme index neÅ™eÅ¡ili. JenÅ¾e <code>pandas</code> na rozdÃ­l od nÃ¡s ano, a tak posluÅ¡nÄ› oba indexy spojil, i za cenu duplicitnÃ­ch hodnot. Za cenu pouÅ¾itÃ­ dodateÄnÃ©ho argumentu <code>ignore_index=True</code> se tomu lze vyhnout, coÅ¾ si ukÃ¡Å¾eme na pÅ™Ã­klady spojovÃ¡nÃ­ dvou tabulek o stejnÃ½ch sloupcÃ­ch:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>0     jedna
1       dvÄ›
2       tÅ™i
3     jedna
4       dvÄ›
5       tÅ™i
6     jedna
7       dvÄ›
8       tÅ™i
9     jedna
10      dvÄ›
11      tÅ™i
12    jedna
13      dvÄ›
14      tÅ™i
dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="vedle_sebe">Vedle sebe
<a class="header-link" href="#vedle_sebe">#</a>
</h4>
<p>Toto asi pouÅ¾ijete zÅ™Ã­dka, ale kdyÅ¾ chceme "lepit" doprava (tÅ™eba deset <code>Series</code>), staÄÃ­ pÅ™idat nÃ¡m dobÅ™e znÃ¡mÃ½ argument <code>axis</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>jedna</td>
<td>jedna</td>
<td>jedna</td>
<td>jedna</td>
<td>jedna</td>
</tr>
<tr>
<th>1</th>
<td>dvÄ›</td>
<td>dvÄ›</td>
<td>dvÄ›</td>
<td>dvÄ›</td>
<td>dvÄ›</td>
</tr>
<tr>
<th>2</th>
<td>tÅ™i</td>
<td>tÅ™i</td>
<td>tÅ™i</td>
<td>tÅ™i</td>
<td>tÅ™i</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>PÅ™Ã­klad:</strong> Jak co nejrychleji "nakreslit prÃ¡zdnou Å¡achovnici" (obÄ› slova jsou v uvozovkÃ¡ch)?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sachy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>   
            <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s2">"â¬œ"</span><span class="p">,</span> <span class="s2">"â¬›"</span><span class="p">],</span> <span class="p">[</span><span class="s2">"â¬›"</span><span class="p">,</span> <span class="s2">"â¬œ"</span><span class="p">]])]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
<span class="p">)</span>
<span class="n">sachy</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">sachy</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">"ABCDEFGH"</span><span class="p">)</span>
<span class="n">sachy</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
<th>G</th>
<th>H</th>
</tr>
</thead>
<tbody>
<tr>
<th>8</th>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
</tr>
<tr>
<th>7</th>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
</tr>
<tr>
<th>6</th>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
</tr>
<tr>
<th>5</th>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
</tr>
<tr>
<th>4</th>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
</tr>
<tr>
<th>3</th>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
</tr>
<tr>
<th>2</th>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
</tr>
<tr>
<th>1</th>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
<td>â¬›</td>
<td>â¬œ</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="spojovani_ruznorodych_tabulek">SpojovÃ¡nÃ­ rÅ¯znorodÃ½ch tabulek
<a class="header-link" href="#spojovani_ruznorodych_tabulek">#</a>
</h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ğŸ¦ Pro spojovÃ¡nÃ­ heterogennÃ­ch dat (v datovÃ© hantÃ½rce "joinovÃ¡nÃ­") sÃ¡hneme po trochu komplexnÄ›jÅ¡Ã­ch filmovÃ½ch datech...</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>MÃ¡me staÅ¾eno nÄ›kolik souborÅ¯, naÄteme si je (zatÃ­m hrubÄ›, "raw") - s pÅ™ihlÃ©dnutÃ­m k tomu, Å¾e prvnÃ­ dva nejsou v pravÃ©m slova smyslu "comma-separated", ale pouÅ¾Ã­vajÃ­ k oddÄ›lenÃ­ hodnot tabulÃ¡tor (tady pomÅ¯Å¾e argument <code>sep</code>). TakÃ© zohlednÃ­me, Å¾e v nich Å™etÄ›zec <code>"\N"</code> pÅ™edstavuje chybÄ›jÃ­cÃ­ hodnoty (pomÅ¯Å¾e argument <code>na_values</code>):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_titles_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"title.basics.tsv.gz"</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">"</span><span class="se">\\</span><span class="s2">N"</span><span class="p">)</span>
<span class="n">imdb_ratings_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"title.ratings.tsv.gz"</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="s2">"</span><span class="se">\\</span><span class="s2">N"</span><span class="p">)</span>
<span class="n">boxoffice_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"boxoffice_march_2019.csv.gz"</span><span class="p">)</span>
<span class="n">rotten_tomatoes_raw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"rotten_tomatoes_top_movies_2019-01-15.csv"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Co kterÃ½ soubor obsahuje?</p>
<ul>
<li><p>PrvnÃ­ dva soubory obsahujÃ­ volnÄ› dostupnÃ¡ (byÅ¥ "jen" pro nekomerÄnÃ­ pouÅ¾itÃ­) data o filmech z IMDb (Internet Movie Database). My jsme si zvolili obecnÃ© informace a uÅ¾ivatelskÃ¡ (ÄÃ­selnÃ¡) hodnocenÃ­. DetailnÃ­ popis souborÅ¯, stejnÄ› jako odkazy na dalÅ¡Ã­ soubory, najdeÅ¡ na https://www.imdb.com/interfaces/. Z dÅ¯vodÅ¯ pamÄ›Å¥ovÃ© nÃ¡roÄnosti jsme datovou sadu oÅ™ezali o epizody seriÃ¡lÅ¯, protoÅ¾e nÃ¡s nebudou zajÃ­mat a s trochu Å¡tÄ›stÃ­ pÅ™eÅ¾ijeme i na poÄÃ­taÄÃ­ch s menÅ¡Ã­ operaÄnÃ­ pamÄ›tÃ­.</p>
</li>
<li><p>Soubor <code>boxoffice_march_2019.csv.gz</code> obsahuje informace o vÃ½dÄ›lcÃ­ch jednotlivÃ½ch filmÅ¯. PochÃ¡zÃ­ z ukÃ¡zkovÃ©ho datasetu pro soutÄ›Å¾ "TMDB Box Office Prediction" na serveru Kaggle: https://www.kaggle.com/c/tmdb-box-office-prediction/data</p>
</li>
<li><p>Soubor <code>rotten_tomatoes_top_movies_2019-01-15.csv</code> obsahuje procentuÃ¡lnÃ­ hodnocenÃ­ filmÅ¯ ze serveru Rotten Tomatoes, kterÃ© se poÄÃ­tÃ¡ jako podÃ­l pozitivnÃ­ch hodnocenÃ­ch od filmovÃ½ch kritiku (je to tedy jinÃ½ princip neÅ¾ na IMDb). StaÅ¾eno z: https://data.world/prasert/rotten-tomatoes-top-movies-by-genre</p>
</li>
</ul>
<p>PojÄme se podÃ­vat na nedostatky tÄ›chto souborÅ¯ a postupnÄ› je sklÃ¡dat dohromady. ZajÃ­malo by nÃ¡s (a snad i tebe!), jak souvisÃ­ hodnocenÃ­ s komerÄnÃ­ ÃºspÄ›Å¡nostÃ­ filmu, jak se liÅ¡Ã­ hodnocenÃ­ rotten tomatoes od tÄ›ch na IMDb.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_titles_raw</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>tconst</th>
<th>titleType</th>
<th>primaryTitle</th>
<th>originalTitle</th>
<th>isAdult</th>
<th>startYear</th>
<th>endYear</th>
<th>runtimeMinutes</th>
<th>genres</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>tt0000001</td>
<td>short</td>
<td>Carmencita</td>
<td>Carmencita</td>
<td>0</td>
<td>1894.0</td>
<td>NaN</td>
<td>1.0</td>
<td>Documentary,Short</td>
</tr>
<tr>
<th>1</th>
<td>tt0000002</td>
<td>short</td>
<td>Le clown et ses chiens</td>
<td>Le clown et ses chiens</td>
<td>0</td>
<td>1892.0</td>
<td>NaN</td>
<td>5.0</td>
<td>Animation,Short</td>
</tr>
<tr>
<th>2</th>
<td>tt0000003</td>
<td>short</td>
<td>Pauvre Pierrot</td>
<td>Pauvre Pierrot</td>
<td>0</td>
<td>1892.0</td>
<td>NaN</td>
<td>4.0</td>
<td>Animation,Comedy,Romance</td>
</tr>
<tr>
<th>3</th>
<td>tt0000004</td>
<td>short</td>
<td>Un bon bock</td>
<td>Un bon bock</td>
<td>0</td>
<td>1892.0</td>
<td>NaN</td>
<td>NaN</td>
<td>Animation,Short</td>
</tr>
<tr>
<th>4</th>
<td>tt0000005</td>
<td>short</td>
<td>Blacksmith Scene</td>
<td>Blacksmith Scene</td>
<td>0</td>
<td>1893.0</td>
<td>NaN</td>
<td>1.0</td>
<td>Comedy,Short</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1783511</th>
<td>tt9916734</td>
<td>video</td>
<td>Manca: Peleo</td>
<td>Manca: Peleo</td>
<td>0</td>
<td>2018.0</td>
<td>NaN</td>
<td>NaN</td>
<td>Music,Short</td>
</tr>
<tr>
<th>1783512</th>
<td>tt9916754</td>
<td>movie</td>
<td>Chico Albuquerque - RevelaÃ§Ãµes</td>
<td>Chico Albuquerque - RevelaÃ§Ãµes</td>
<td>0</td>
<td>2013.0</td>
<td>NaN</td>
<td>NaN</td>
<td>Documentary</td>
</tr>
<tr>
<th>1783513</th>
<td>tt9916756</td>
<td>short</td>
<td>Pretty Pretty Black Girl</td>
<td>Pretty Pretty Black Girl</td>
<td>0</td>
<td>2019.0</td>
<td>NaN</td>
<td>NaN</td>
<td>Short</td>
</tr>
<tr>
<th>1783514</th>
<td>tt9916764</td>
<td>short</td>
<td>38</td>
<td>38</td>
<td>0</td>
<td>2018.0</td>
<td>NaN</td>
<td>NaN</td>
<td>Short</td>
</tr>
<tr>
<th>1783515</th>
<td>tt9916856</td>
<td>short</td>
<td>The Wind</td>
<td>The Wind</td>
<td>0</td>
<td>2015.0</td>
<td>NaN</td>
<td>27.0</td>
<td>Short</td>
</tr>
</tbody>
</table>
<p>1783516 rows Ã— 9 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Kolik tabulka zabÃ­rÃ¡ megabajtÅ¯ pamÄ›ti? (1 MB = 2**20 bajtÅ¯)</span>
<span class="n">imdb_titles_raw</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="mi">20</span> 
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>648.8971881866455</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>JistÄ› budeme chtÃ­t pÅ™evÃ©st sloupce na sprÃ¡vnÃ© typy. JakÃ© jsou v zÃ¡kladu?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_titles_raw</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>tconst             object
titleType          object
primaryTitle       object
originalTitle      object
isAdult             int64
startYear         float64
endYear           float64
runtimeMinutes    float64
genres             object
dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Na co budeme pÅ™evÃ¡dÄ›t?</p>
<ul>
<li><code>tconst</code> je Å™etÄ›zec, kterÃ½ poslÃ©ze pouÅ¾ijeme jako index, protoÅ¾e pÅ™edstavuje unikÃ¡tnÃ­ identifikÃ¡tor v databÃ¡zi IMDb.</li>
<li><code>titleType</code>:</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"titleType"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>titleType
short           676930
movie           514654
video           227582
tvSeries        162781
tvMovie         126507
tvMiniSeries     25574
videoGame        23310
tvSpecial        17007
tvShort           9171
Name: count, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Jen devÄ›t rÅ¯znÃ½ch hodnot ve skoro 2 milionech Å™Ã¡dkÅ¯? To je ideÃ¡lnÃ­ kandidÃ¡t na pÅ™evedenÃ­ na typ <code>"category"</code>.</p>
<ul>
<li><code>primaryTitle</code> a <code>originalTitle</code> vypadajÃ­ jako obyÄejnÃ© Å™etÄ›zce (pokud moÅ¾no anglickÃ½ a pokud moÅ¾no pÅ¯vodnÃ­ nÃ¡zev)</li>
<li><code>isAdult</code> urÄuje, zda se jednÃ¡ o dÃ­lo pro dospÄ›lÃ©. Tento sloupec bychom nejspÃ­Å¡e mÄ›li pÅ™evÃ©st na <code>bool</code>.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"isAdult"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[12]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>isAdult
0    1692292
1      91224
Name: count, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><code>startYear</code> a <code>endYear</code> obsahujÃ­ roky, t.j. celÃ¡ ÄÃ­sla, ovÅ¡em kvÅ¯li chybÄ›jÃ­cÃ­m hodnotÃ¡m je pro nÄ› zvolen typ <code>float64</code>. V <code>pandas</code> radÄ›ji zvolÃ­me tzv. "nullable integer", kterÃ½ se zapisuje s velkÃ½m "I". KdyÅ¾ nevÃ­Å¡, jakÃ½ podtyp konkrÃ©tnÄ›, sÃ¡hni po <code>Int64</code>.</li>
<li>totÃ©Å¾ platÃ­ pro <code>runtimeMinutes</code>.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_titles_raw</span><span class="p">[[</span><span class="s2">"startYear"</span><span class="p">,</span> <span class="s2">"endYear"</span><span class="p">,</span> <span class="s2">"runtimeMinutes"</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[13]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>startYear           2115.0
endYear             2027.0
runtimeMinutes    125156.0
dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Mimochodem vÅ¡imli jste si, Å¾e mÃ¡me dÃ­la z budoucnosti (rok 2115)?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"startYear"</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
<span class="n">imdb_titles_raw</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"startYear &gt; 2019"</span><span class="p">)[</span><span class="s2">"startYear"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[14]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>startYear
2020.0    340
2021.0     36
2022.0     14
2023.0      1
2024.0      2
2025.0      1
2115.0      1
Name: count, dtype: int64</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjcAAAGsCAYAAAAhYYazAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8pXeV/AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAqCElEQVR4nO3de1zVdZ7H8fcB5SApqCHghcR7FxXJC8OkTU4kKg83c2bXtUxjtFnLGpKspAuMNSOaydqumpPrJXe2vOya06RihprrxOaKUNl6N8MLoKZyFAuQ89s/fHjqBCocjhz4+no+Hufx6HzP9/c7n9/3ceS8+57v7/ezWZZlCQAAwBB+vi4AAADAmwg3AADAKIQbAABgFMINAAAwCuEGAAAYhXADAACMQrgBAABGIdwAAACjEG4AAIBRCDcAAMAoN3W42bZtm0aMGKF27drJZrNp7dq1td6HZVl644031L17d9ntdrVv315//OMfvV8sAACokSa+LsCXSktLFR0drd/85jcaNWqUR/tITk7WRx99pDfeeEO9evXSmTNndObMGS9XCgAAasrGjTMvs9lsev/99zVy5EhXW1lZmV566SW99957OnfunHr27KlZs2bpvvvukyTt2bNHvXv31u7du9WjRw/fFA4AANzc1D9LXc9TTz2lnJwcrVixQl988YX+/u//XkOHDtWBAwckSX/961/VuXNnffjhh+rUqZOioqI0ceJEZm4AAPAhws1VFBQUaOnSpVq9erUGDRqkLl26aOrUqRo4cKCWLl0qSTp8+LC++eYbrV69WsuXL9eyZcuUm5urX//61z6uHgCAm9dNvebmWr788ktVVlaqe/fubu1lZWW69dZbJUlOp1NlZWVavny5q9/ixYvVt29f7du3j5+qAADwAcLNVVy4cEH+/v7Kzc2Vv7+/22vNmzeXJLVt21ZNmjRxC0B33HGHpMszP4QbAADqH+HmKmJiYlRZWamTJ09q0KBB1fa55557dOnSJR06dEhdunSRJO3fv1+S1LFjx3qrFQAA/OCmPlvqwoULOnjwoKTLYSYzM1ODBw9W69atddttt2ns2LH629/+pjlz5igmJkanTp1Sdna2evfurcTERDmdTvXv31/NmzfX3Llz5XQ6NXnyZAUHB+ujjz7y8dEBAHBzuqnDzdatWzV48OAq7ePHj9eyZctUUVGhP/zh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">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Takhle nÄ›jak by pÅ™etypovÃ¡nÃ­ mohlo vypadat:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="p">(</span>
    <span class="n">imdb_titles_raw</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">titleType</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"titleType"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"category"</span><span class="p">),</span>
        <span class="n">startYear</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"startYear"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"Int64"</span><span class="p">),</span>
        <span class="n">endYear</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"endYear"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"Int64"</span><span class="p">),</span>
        <span class="n">isAdult</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"isAdult"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
        <span class="n">runtimeMinutes</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"runtimeMinutes"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"Int64"</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[15]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>tconst              object
titleType         category
primaryTitle        object
originalTitle       object
isAdult               bool
startYear            Int64
endYear              Int64
runtimeMinutes       Int64
genres              object
dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Takhle uÅ¾ by to mohlo bÃ½t. Jen si jeÅ¡tÄ›:</p>
<ul>
<li>pro pÅ™ehlednost pÅ™ejmenujeme nÄ›kterÃ© sloupce (pomocÃ­ metody <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rename.html"><code>rename</code></a>)</li>
<li>pouÅ¾ijeme <code>tconst</code> jako index</li>
</ul>
<p>A tabulka <code>imdb_titles</code> bude pÅ™ipravenÃ¡ k pouÅ¾itÃ­!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_titles</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">imdb_titles_raw</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">titleType</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"titleType"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"category"</span><span class="p">),</span>
        <span class="n">startYear</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"startYear"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"Int64"</span><span class="p">),</span>
        <span class="n">endYear</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"endYear"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"Int64"</span><span class="p">),</span>
        <span class="n">isAdult</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"isAdult"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">),</span>
        <span class="n">runtimeMinutes</span><span class="o">=</span><span class="n">imdb_titles_raw</span><span class="p">[</span><span class="s2">"runtimeMinutes"</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"Int64"</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span>
        <span class="s2">"primaryTitle"</span><span class="p">:</span> <span class="s2">"title"</span><span class="p">,</span>
        <span class="s2">"originalTitle"</span><span class="p">:</span> <span class="s2">"original_title"</span><span class="p">,</span>
        <span class="s2">"titleType"</span><span class="p">:</span> <span class="s2">"title_type"</span><span class="p">,</span>
        <span class="s2">"runtimeMinutes"</span><span class="p">:</span> <span class="s2">"length"</span><span class="p">,</span>
        <span class="s2">"startYear"</span><span class="p">:</span> <span class="s2">"start_year"</span><span class="p">,</span>
        <span class="s2">"endYear"</span><span class="p">:</span> <span class="s2">"end_year"</span><span class="p">,</span>
        <span class="s2">"isAdult"</span><span class="p">:</span> <span class="s2">"is_adult"</span><span class="p">,</span>
    <span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"tconst"</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">imdb_titles</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[16]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title_type</th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>start_year</th>
<th>end_year</th>
<th>length</th>
<th>genres</th>
</tr>
<tr>
<th>tconst</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>tt0000001</th>
<td>short</td>
<td>Carmencita</td>
<td>Carmencita</td>
<td>False</td>
<td>1894</td>
<td>&lt;NA&gt;</td>
<td>1</td>
<td>Documentary,Short</td>
</tr>
<tr>
<th>tt0000002</th>
<td>short</td>
<td>Le clown et ses chiens</td>
<td>Le clown et ses chiens</td>
<td>False</td>
<td>1892</td>
<td>&lt;NA&gt;</td>
<td>5</td>
<td>Animation,Short</td>
</tr>
<tr>
<th>tt0000003</th>
<td>short</td>
<td>Pauvre Pierrot</td>
<td>Pauvre Pierrot</td>
<td>False</td>
<td>1892</td>
<td>&lt;NA&gt;</td>
<td>4</td>
<td>Animation,Comedy,Romance</td>
</tr>
<tr>
<th>tt0000004</th>
<td>short</td>
<td>Un bon bock</td>
<td>Un bon bock</td>
<td>False</td>
<td>1892</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>Animation,Short</td>
</tr>
<tr>
<th>tt0000005</th>
<td>short</td>
<td>Blacksmith Scene</td>
<td>Blacksmith Scene</td>
<td>False</td>
<td>1893</td>
<td>&lt;NA&gt;</td>
<td>1</td>
<td>Comedy,Short</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>tt9916734</th>
<td>video</td>
<td>Manca: Peleo</td>
<td>Manca: Peleo</td>
<td>False</td>
<td>2018</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>Music,Short</td>
</tr>
<tr>
<th>tt9916754</th>
<td>movie</td>
<td>Chico Albuquerque - RevelaÃ§Ãµes</td>
<td>Chico Albuquerque - RevelaÃ§Ãµes</td>
<td>False</td>
<td>2013</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>Documentary</td>
</tr>
<tr>
<th>tt9916756</th>
<td>short</td>
<td>Pretty Pretty Black Girl</td>
<td>Pretty Pretty Black Girl</td>
<td>False</td>
<td>2019</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>Short</td>
</tr>
<tr>
<th>tt9916764</th>
<td>short</td>
<td>38</td>
<td>38</td>
<td>False</td>
<td>2018</td>
<td>&lt;NA&gt;</td>
<td>&lt;NA&gt;</td>
<td>Short</td>
</tr>
<tr>
<th>tt9916856</th>
<td>short</td>
<td>The Wind</td>
<td>The Wind</td>
<td>False</td>
<td>2015</td>
<td>&lt;NA&gt;</td>
<td>27</td>
<td>Short</td>
</tr>
</tbody>
</table>
<p>1783516 rows Ã— 8 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Kolik tabulka zabÃ­rÃ¡ megabajtÅ¯ pamÄ›ti?</span>
<span class="n">imdb_titles</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="mi">20</span>   <span class="c1"># O chlup mÃ©nÄ›, zase tolik jsme si ale nepomohli.</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[17]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>537.2908029556274</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>PÅ™ipravÃ­me si jeÅ¡tÄ› speciÃ¡lnÃ­ tabulku jenom pro filmy, protoÅ¾e dalÅ¡Ã­ datovÃ© sady se zabÃ½vajÃ­ jenom jimi.</p>
<p>U tÃ©to tabulky navÃ­c vyhodÃ­me zbyteÄnÃ© sloupce <code>title_type</code>, <code>end_year</code> a pÅ™ejmenujeme <code>start_year</code> prostÄ› na <code>year</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">movies</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">imdb_titles</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"title_type == 'movie'"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">"title_type"</span><span class="p">,</span> <span class="s2">"end_year"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">"start_year"</span><span class="p">:</span> <span class="s2">"year"</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">movies</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
</tr>
<tr>
<th>tconst</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>tt0000009</th>
<td>Miss Jerry</td>
<td>Miss Jerry</td>
<td>False</td>
<td>1894</td>
<td>45</td>
<td>Romance</td>
</tr>
<tr>
<th>tt0000147</th>
<td>The Corbett-Fitzsimmons Fight</td>
<td>The Corbett-Fitzsimmons Fight</td>
<td>False</td>
<td>1897</td>
<td>20</td>
<td>Documentary,News,Sport</td>
</tr>
<tr>
<th>tt0000335</th>
<td>Soldiers of the Cross</td>
<td>Soldiers of the Cross</td>
<td>False</td>
<td>1900</td>
<td>&lt;NA&gt;</td>
<td>Biography,Drama</td>
</tr>
<tr>
<th>tt0000502</th>
<td>Bohemios</td>
<td>Bohemios</td>
<td>False</td>
<td>1905</td>
<td>100</td>
<td>NaN</td>
</tr>
<tr>
<th>tt0000574</th>
<td>The Story of the Kelly Gang</td>
<td>The Story of the Kelly Gang</td>
<td>False</td>
<td>1906</td>
<td>70</td>
<td>Biography,Crime,Drama</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>tt9916622</th>
<td>Rodolpho TeÃ³philo - O Legado de um Pioneiro</td>
<td>Rodolpho TeÃ³philo - O Legado de um Pioneiro</td>
<td>False</td>
<td>2015</td>
<td>&lt;NA&gt;</td>
<td>Documentary</td>
</tr>
<tr>
<th>tt9916680</th>
<td>De la ilusiÃ³n al desconcierto: cine colombiano...</td>
<td>De la ilusiÃ³n al desconcierto: cine colombiano...</td>
<td>False</td>
<td>2007</td>
<td>100</td>
<td>Documentary</td>
</tr>
<tr>
<th>tt9916706</th>
<td>Dankyavar Danka</td>
<td>Dankyavar Danka</td>
<td>False</td>
<td>2013</td>
<td>&lt;NA&gt;</td>
<td>Comedy</td>
</tr>
<tr>
<th>tt9916730</th>
<td>6 Gunn</td>
<td>6 Gunn</td>
<td>False</td>
<td>2017</td>
<td>116</td>
<td>NaN</td>
</tr>
<tr>
<th>tt9916754</th>
<td>Chico Albuquerque - RevelaÃ§Ãµes</td>
<td>Chico Albuquerque - RevelaÃ§Ãµes</td>
<td>False</td>
<td>2013</td>
<td>&lt;NA&gt;</td>
<td>Documentary</td>
</tr>
</tbody>
</table>
<p>514654 rows Ã— 6 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">movies</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">movies</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(514654, 6)
title             object
original_title    object
is_adult            bool
year               Int64
length             Int64
genres            object
dtype: object
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>NynÃ­ se podÃ­vÃ¡me na zoubek hodnocenÃ­m z IMDb, na tabulky <code>imdb_ratings_raw</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_ratings_raw</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>tconst</th>
<th>averageRating</th>
<th>numVotes</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>tt0000001</td>
<td>5.8</td>
<td>1486</td>
</tr>
<tr>
<th>1</th>
<td>tt0000002</td>
<td>6.4</td>
<td>179</td>
</tr>
<tr>
<th>2</th>
<td>tt0000003</td>
<td>6.6</td>
<td>1117</td>
</tr>
<tr>
<th>3</th>
<td>tt0000004</td>
<td>6.4</td>
<td>109</td>
</tr>
<tr>
<th>4</th>
<td>tt0000005</td>
<td>6.2</td>
<td>1820</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>923691</th>
<td>tt9916380</td>
<td>9.7</td>
<td>58</td>
</tr>
<tr>
<th>923692</th>
<td>tt9916420</td>
<td>7.0</td>
<td>5</td>
</tr>
<tr>
<th>923693</th>
<td>tt9916460</td>
<td>9.2</td>
<td>12</td>
</tr>
<tr>
<th>923694</th>
<td>tt9916720</td>
<td>5.2</td>
<td>11</td>
</tr>
<tr>
<th>923695</th>
<td>tt9916766</td>
<td>7.2</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>923696 rows Ã— 3 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">imdb_ratings_raw</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[21]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>tconst            object
averageRating    float64
numVotes           int64
dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To by vlastnÄ› skoro mohlo bÃ½t!</p>
<p>Tak jen nastavÃ­me index (opÄ›t <code>tconst</code>) a pÅ™ejmenujeme sloupce:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">ratings</span> <span class="o">=</span> <span class="p">(</span><span class="n">imdb_ratings_raw</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span>
        <span class="s2">"averageRating"</span><span class="p">:</span> <span class="s2">"imdb_rating"</span><span class="p">,</span>
        <span class="s2">"numVotes"</span><span class="p">:</span> <span class="s2">"imdb_votes"</span>
    <span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">"tconst"</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">ratings</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>imdb_rating</th>
<th>imdb_votes</th>
</tr>
<tr>
<th>tconst</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>tt0000001</th>
<td>5.8</td>
<td>1486</td>
</tr>
<tr>
<th>tt0000002</th>
<td>6.4</td>
<td>179</td>
</tr>
<tr>
<th>tt0000003</th>
<td>6.6</td>
<td>1117</td>
</tr>
<tr>
<th>tt0000004</th>
<td>6.4</td>
<td>109</td>
</tr>
<tr>
<th>tt0000005</th>
<td>6.2</td>
<td>1820</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>tt9916380</th>
<td>9.7</td>
<td>58</td>
</tr>
<tr>
<th>tt9916420</th>
<td>7.0</td>
<td>5</td>
</tr>
<tr>
<th>tt9916460</th>
<td>9.2</td>
<td>12</td>
</tr>
<tr>
<th>tt9916720</th>
<td>5.2</td>
<td>11</td>
</tr>
<tr>
<th>tt9916766</th>
<td>7.2</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>923696 rows Ã— 2 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="prvni_join">PrvnÃ­ join
<a class="header-link" href="#prvni_join">#</a>
</h4>
<p>MÃ¡me pÅ™ipravenÃ© dvÄ› krÃ¡snÃ© tabulky, kterÃ© sdÃ­lejÃ­ stejnÃ½ index, a mÅ¯Å¾eme vesele spojovat. ProtoÅ¾e pomocÃ­ <code>join</code>, <code>merge</code> a <code>concat</code> lze volbou vhodnÃ½ch parametrÅ¯ dosÃ¡hnout identickÃ©ho vÃ½sledku (coÅ¾ je jednÃ­m z neÅ¡varÅ¯ knihovny <code>pandas</code>), ukÃ¡Å¾eme si vÅ¡echny tÅ™i alternativy podle subjektivnÃ­ho poÅ™adÃ­ vhodnosti.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ratings</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[23]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
</tr>
<tr>
<th>tconst</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>tt0000009</th>
<td>Miss Jerry</td>
<td>Miss Jerry</td>
<td>False</td>
<td>1894</td>
<td>45</td>
<td>Romance</td>
<td>5.5</td>
<td>77.0</td>
</tr>
<tr>
<th>tt0000147</th>
<td>The Corbett-Fitzsimmons Fight</td>
<td>The Corbett-Fitzsimmons Fight</td>
<td>False</td>
<td>1897</td>
<td>20</td>
<td>Documentary,News,Sport</td>
<td>5.2</td>
<td>289.0</td>
</tr>
<tr>
<th>tt0000335</th>
<td>Soldiers of the Cross</td>
<td>Soldiers of the Cross</td>
<td>False</td>
<td>1900</td>
<td>&lt;NA&gt;</td>
<td>Biography,Drama</td>
<td>6.3</td>
<td>39.0</td>
</tr>
<tr>
<th>tt0000502</th>
<td>Bohemios</td>
<td>Bohemios</td>
<td>False</td>
<td>1905</td>
<td>100</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>tt0000574</th>
<td>The Story of the Kelly Gang</td>
<td>The Story of the Kelly Gang</td>
<td>False</td>
<td>1906</td>
<td>70</td>
<td>Biography,Crime,Drama</td>
<td>6.2</td>
<td>505.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>tt9916622</th>
<td>Rodolpho TeÃ³philo - O Legado de um Pioneiro</td>
<td>Rodolpho TeÃ³philo - O Legado de um Pioneiro</td>
<td>False</td>
<td>2015</td>
<td>&lt;NA&gt;</td>
<td>Documentary</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>tt9916680</th>
<td>De la ilusiÃ³n al desconcierto: cine colombiano...</td>
<td>De la ilusiÃ³n al desconcierto: cine colombiano...</td>
<td>False</td>
<td>2007</td>
<td>100</td>
<td>Documentary</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>tt9916706</th>
<td>Dankyavar Danka</td>
<td>Dankyavar Danka</td>
<td>False</td>
<td>2013</td>
<td>&lt;NA&gt;</td>
<td>Comedy</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>tt9916730</th>
<td>6 Gunn</td>
<td>6 Gunn</td>
<td>False</td>
<td>2017</td>
<td>116</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>tt9916754</th>
<td>Chico Albuquerque - RevelaÃ§Ãµes</td>
<td>Chico Albuquerque - RevelaÃ§Ãµes</td>
<td>False</td>
<td>2013</td>
<td>&lt;NA&gt;</td>
<td>Documentary</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>514654 rows Ã— 8 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>K tabulce se nenÃ¡padnÄ› pÅ™idaly dva sloupce z tabulky <code>ratings</code>, a to takovÃ½m zpÅ¯sobem, Å¾e se porovnaly hodnoty indexu (tedy <code>tconst</code>) a spÃ¡rovaly se ty ÄÃ¡sti Å™Ã¡dku, kde se tento index shoduje.</p>
<p>ğŸ’¡ UvÄ›dom si (aÄkoliv z volÃ¡nÃ­ funkcÃ­ v <code>pandas</code> to nenÃ­ ÃºplnÄ› zÅ™ejmÃ©), Å¾e se tady dÄ›je nÄ›co fundamentÃ¡lnÄ› odliÅ¡nÃ©ho od "nalepenÃ­ doprava" - tabulky tu nejsou chÃ¡pÃ¡ny jako ÄtvereÄky, kterÃ© jde sklÃ¡dat jako lego, nÃ½brÅ¾ jako zdroj ÃºdajÅ¯ o jednotlivÃ½ch objektech, kterÃ© je potÅ™eba spojit sÃ©manticky.</p>
<p>Jak ale vidÃ­Å¡, tabulka obsahuje spoustu Å™Ã¡dkÅ¯, kde ve sloupcÃ­ch s hodnocenÃ­m chybÃ­ hodnoty (respektive nachÃ¡zÃ­ se <code>NaN</code>). To vychÃ¡zÃ­ ze zpÅ¯sobu, jakÃ½m metoda <code>join</code> ve vÃ½chozÃ­m nastavenÃ­ "joinuje" - pouÅ¾ije vÅ¡echny Å™Ã¡dky z levÃ© tabulky bez ohledu na to, jestli jim odpovÃ­dÃ¡ nÄ›jakÃ½ protÄ›jÅ¡ek v tabulce pravÃ©. NaÅ¡tÄ›stÃ­ lze pomocÃ­ argumentu <code>how</code> specifikovat i jinÃ© zpÅ¯soby spojovÃ¡nÃ­:</p>
<ul>
<li><code>left</code> (vÃ½chozÃ­ pro metodu <code>join</code>) - vezmou se vÅ¡echny prvky z levÃ© tabulky a jim odpovÃ­dajÃ­cÃ­ prvky z pravÃ© tabulky (kde nejsou, doplnÃ­ se <code>NaN</code>)</li>
<li><code>right</code> - vezmou se vÅ¡echny prvky z pravÃ© tabulky a jim odpovÃ­dajÃ­cÃ­ prvky z levÃ© tabulky (kde nejsou, doplnÃ­ se <code>NaN</code>)</li>
<li><code>inner</code> (vÃ½chozÃ­ pro funkci <code>merge</code>) - vezmou se jen ty prvky, kterÃ© jsou v levÃ© i pravÃ© tabulce.</li>
<li><code>outer</code> (vÃ½chozÃ­ pro funkci <code>concat</code>) - vezmou se vÅ¡echny prvky, z levÃ© i pravÃ© tabulky, kde nÄ›co chybÃ­, doplnÃ­ se <code>NaN</code>.</li>
</ul>
<p>V podobÄ› VennovÄ› diagramu, kde kruhy pÅ™edstavujÃ­ mnoÅ¾iny Å™Ã¡dkÅ¯ v obou zdrojovÃ½ch tabulkÃ¡ch a modrou barvou jsou zvÃ½raznÄ›ny Å™Ã¡dky v tabulce cÃ­lovÃ©:</p>
<p><img alt="Typy joinÅ¯" src="/2024/pydata-praha-podzim/pydata/pandas_joins/static/joins.svg"></p>
<p><em>ObrÃ¡zek adaptovÃ¡n z https://upload.wikimedia.org/wikipedia/commons/9/9d/SQL_Joins.svg (autor: Arbeck)</em></p>
<p>ğŸ’¡ AÅ¾ budeme probÃ­rat databÃ¡ze, tyto ÄtyÅ™i typu joinÅ¯ se nÃ¡m znovu vynoÅ™Ã­.</p>
<p>NÃ¡sledujÃ­cÃ­ vÃ½pis ukÃ¡Å¾e, kolik Å™Ã¡dkÅ¯ bychom dostali pÅ™i pouÅ¾itÃ­ rÅ¯znÃ½ch hodnot <code>how</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">how</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"left"</span><span class="p">,</span> <span class="s2">"right"</span><span class="p">,</span> <span class="s2">"inner"</span><span class="p">,</span> <span class="s2">"outer"</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"movies.join(ratings, how=</span><span class="se">\"</span><span class="si">{</span><span class="n">how</span><span class="si">}</span><span class="se">\"</span><span class="s2">):"</span><span class="p">,</span> <span class="n">movies</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ratings</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Å™Ã¡dkÅ¯."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>movies.join(ratings, how="left"): 514654 Å™Ã¡dkÅ¯.
movies.join(ratings, how="right"): 923696 Å™Ã¡dkÅ¯.
movies.join(ratings, how="inner"): 232496 Å™Ã¡dkÅ¯.
movies.join(ratings, how="outer"): 1205854 Å™Ã¡dkÅ¯.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A teÄ tedy ty tÅ™i alternativy:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Alternativa 1 (preferovanÃ¡)</span>
<span class="n">movies_with_rating</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ratings</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">"inner"</span><span class="p">)</span>
<span class="n">movies_with_rating</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[25]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
</tr>
<tr>
<th>tconst</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>tt0000009</th>
<td>Miss Jerry</td>
<td>Miss Jerry</td>
<td>False</td>
<td>1894</td>
<td>45</td>
<td>Romance</td>
<td>5.5</td>
<td>77</td>
</tr>
<tr>
<th>tt0000147</th>
<td>The Corbett-Fitzsimmons Fight</td>
<td>The Corbett-Fitzsimmons Fight</td>
<td>False</td>
<td>1897</td>
<td>20</td>
<td>Documentary,News,Sport</td>
<td>5.2</td>
<td>289</td>
</tr>
<tr>
<th>tt0000335</th>
<td>Soldiers of the Cross</td>
<td>Soldiers of the Cross</td>
<td>False</td>
<td>1900</td>
<td>&lt;NA&gt;</td>
<td>Biography,Drama</td>
<td>6.3</td>
<td>39</td>
</tr>
<tr>
<th>tt0000574</th>
<td>The Story of the Kelly Gang</td>
<td>The Story of the Kelly Gang</td>
<td>False</td>
<td>1906</td>
<td>70</td>
<td>Biography,Crime,Drama</td>
<td>6.2</td>
<td>505</td>
</tr>
<tr>
<th>tt0000615</th>
<td>Robbery Under Arms</td>
<td>Robbery Under Arms</td>
<td>False</td>
<td>1907</td>
<td>&lt;NA&gt;</td>
<td>Drama</td>
<td>4.8</td>
<td>14</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>tt9910930</th>
<td>Jeg ser deg</td>
<td>Jeg ser deg</td>
<td>False</td>
<td>2019</td>
<td>75</td>
<td>Crime,Documentary</td>
<td>4.6</td>
<td>5</td>
</tr>
<tr>
<th>tt9911774</th>
<td>Padmavyuhathile Abhimanyu</td>
<td>Padmavyuhathile Abhimanyu</td>
<td>False</td>
<td>2019</td>
<td>130</td>
<td>Drama</td>
<td>8.5</td>
<td>363</td>
</tr>
<tr>
<th>tt9913056</th>
<td>Swarm Season</td>
<td>Swarm Season</td>
<td>False</td>
<td>2019</td>
<td>86</td>
<td>Documentary</td>
<td>6.2</td>
<td>5</td>
</tr>
<tr>
<th>tt9913084</th>
<td>Diabolik sono io</td>
<td>Diabolik sono io</td>
<td>False</td>
<td>2019</td>
<td>75</td>
<td>Documentary</td>
<td>6.2</td>
<td>6</td>
</tr>
<tr>
<th>tt9914286</th>
<td>Sokagin Ã‡ocuklari</td>
<td>Sokagin Ã‡ocuklari</td>
<td>False</td>
<td>2019</td>
<td>98</td>
<td>Drama,Family</td>
<td>9.8</td>
<td>72</td>
</tr>
</tbody>
</table>
<p>232496 rows Ã— 8 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Alternativa 2 (taky dobrÃ¡)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">movies</span><span class="p">,</span> <span class="n">ratings</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[26]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
</tr>
<tr>
<th>tconst</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>tt0000009</th>
<td>Miss Jerry</td>
<td>Miss Jerry</td>
<td>False</td>
<td>1894</td>
<td>45</td>
<td>Romance</td>
<td>5.5</td>
<td>77</td>
</tr>
<tr>
<th>tt0000147</th>
<td>The Corbett-Fitzsimmons Fight</td>
<td>The Corbett-Fitzsimmons Fight</td>
<td>False</td>
<td>1897</td>
<td>20</td>
<td>Documentary,News,Sport</td>
<td>5.2</td>
<td>289</td>
</tr>
<tr>
<th>tt0000335</th>
<td>Soldiers of the Cross</td>
<td>Soldiers of the Cross</td>
<td>False</td>
<td>1900</td>
<td>&lt;NA&gt;</td>
<td>Biography,Drama</td>
<td>6.3</td>
<td>39</td>
</tr>
<tr>
<th>tt0000574</th>
<td>The Story of the Kelly Gang</td>
<td>The Story of the Kelly Gang</td>
<td>False</td>
<td>1906</td>
<td>70</td>
<td>Biography,Crime,Drama</td>
<td>6.2</td>
<td>505</td>
</tr>
<tr>
<th>tt0000615</th>
<td>Robbery Under Arms</td>
<td>Robbery Under Arms</td>
<td>False</td>
<td>1907</td>
<td>&lt;NA&gt;</td>
<td>Drama</td>
<td>4.8</td>
<td>14</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>tt9910930</th>
<td>Jeg ser deg</td>
<td>Jeg ser deg</td>
<td>False</td>
<td>2019</td>
<td>75</td>
<td>Crime,Documentary</td>
<td>4.6</td>
<td>5</td>
</tr>
<tr>
<th>tt9911774</th>
<td>Padmavyuhathile Abhimanyu</td>
<td>Padmavyuhathile Abhimanyu</td>
<td>False</td>
<td>2019</td>
<td>130</td>
<td>Drama</td>
<td>8.5</td>
<td>363</td>
</tr>
<tr>
<th>tt9913056</th>
<td>Swarm Season</td>
<td>Swarm Season</td>
<td>False</td>
<td>2019</td>
<td>86</td>
<td>Documentary</td>
<td>6.2</td>
<td>5</td>
</tr>
<tr>
<th>tt9913084</th>
<td>Diabolik sono io</td>
<td>Diabolik sono io</td>
<td>False</td>
<td>2019</td>
<td>75</td>
<td>Documentary</td>
<td>6.2</td>
<td>6</td>
</tr>
<tr>
<th>tt9914286</th>
<td>Sokagin Ã‡ocuklari</td>
<td>Sokagin Ã‡ocuklari</td>
<td>False</td>
<td>2019</td>
<td>98</td>
<td>Drama,Family</td>
<td>9.8</td>
<td>72</td>
</tr>
</tbody>
</table>
<p>232496 rows Ã— 8 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [27]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Alternativa 3 (mÃ©nÄ› "sÃ©mantickÃ¡")</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">movies</span><span class="p">,</span> <span class="n">ratings</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">"inner"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[27]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
</tr>
<tr>
<th>tconst</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>tt0000009</th>
<td>Miss Jerry</td>
<td>Miss Jerry</td>
<td>False</td>
<td>1894</td>
<td>45</td>
<td>Romance</td>
<td>5.5</td>
<td>77</td>
</tr>
<tr>
<th>tt0000147</th>
<td>The Corbett-Fitzsimmons Fight</td>
<td>The Corbett-Fitzsimmons Fight</td>
<td>False</td>
<td>1897</td>
<td>20</td>
<td>Documentary,News,Sport</td>
<td>5.2</td>
<td>289</td>
</tr>
<tr>
<th>tt0000335</th>
<td>Soldiers of the Cross</td>
<td>Soldiers of the Cross</td>
<td>False</td>
<td>1900</td>
<td>&lt;NA&gt;</td>
<td>Biography,Drama</td>
<td>6.3</td>
<td>39</td>
</tr>
<tr>
<th>tt0000574</th>
<td>The Story of the Kelly Gang</td>
<td>The Story of the Kelly Gang</td>
<td>False</td>
<td>1906</td>
<td>70</td>
<td>Biography,Crime,Drama</td>
<td>6.2</td>
<td>505</td>
</tr>
<tr>
<th>tt0000615</th>
<td>Robbery Under Arms</td>
<td>Robbery Under Arms</td>
<td>False</td>
<td>1907</td>
<td>&lt;NA&gt;</td>
<td>Drama</td>
<td>4.8</td>
<td>14</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>tt9910930</th>
<td>Jeg ser deg</td>
<td>Jeg ser deg</td>
<td>False</td>
<td>2019</td>
<td>75</td>
<td>Crime,Documentary</td>
<td>4.6</td>
<td>5</td>
</tr>
<tr>
<th>tt9911774</th>
<td>Padmavyuhathile Abhimanyu</td>
<td>Padmavyuhathile Abhimanyu</td>
<td>False</td>
<td>2019</td>
<td>130</td>
<td>Drama</td>
<td>8.5</td>
<td>363</td>
</tr>
<tr>
<th>tt9913056</th>
<td>Swarm Season</td>
<td>Swarm Season</td>
<td>False</td>
<td>2019</td>
<td>86</td>
<td>Documentary</td>
<td>6.2</td>
<td>5</td>
</tr>
<tr>
<th>tt9913084</th>
<td>Diabolik sono io</td>
<td>Diabolik sono io</td>
<td>False</td>
<td>2019</td>
<td>75</td>
<td>Documentary</td>
<td>6.2</td>
<td>6</td>
</tr>
<tr>
<th>tt9914286</th>
<td>Sokagin Ã‡ocuklari</td>
<td>Sokagin Ã‡ocuklari</td>
<td>False</td>
<td>2019</td>
<td>98</td>
<td>Drama,Family</td>
<td>9.8</td>
<td>72</td>
</tr>
</tbody>
</table>
<p>232496 rows Ã— 8 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Zkusme si zreprodukovat poÅ™adÃ­ 250 nejlepÅ¡Ã­ch filmÅ¯ z IMDb (viz https://www.imdb.com/chart/top/?ref_=nv_mv_250):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Ty nejlepÅ¡Ã­ (do Äervna 2019)</span>
<span class="p">(</span><span class="n">movies_with_rating</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"imdb_votes &gt; 25000"</span><span class="p">)</span>                  <span class="c1"># Berou se jen filmy s vÃ­ce neÅ¾ 25000 hlasy</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">"imdb_rating"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># IMDb tu pouÅ¾ivÃ¡ i vÃ¡hu jednotlivÃ½ch hlasÅ¯ (kterou neznÃ¡me)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">250</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[28]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>The Chaos Class</td>
<td>Hababam Sinifi</td>
<td>False</td>
<td>1975</td>
<td>87</td>
<td>Comedy,Drama</td>
<td>9.4</td>
<td>33394</td>
</tr>
<tr>
<th>1</th>
<td>The Shawshank Redemption</td>
<td>The Shawshank Redemption</td>
<td>False</td>
<td>1994</td>
<td>142</td>
<td>Drama</td>
<td>9.3</td>
<td>2071759</td>
</tr>
<tr>
<th>2</th>
<td>The Mountain II</td>
<td>Dag II</td>
<td>False</td>
<td>2016</td>
<td>135</td>
<td>Action,Drama,War</td>
<td>9.3</td>
<td>100095</td>
</tr>
<tr>
<th>3</th>
<td>CM101MMXI Fundamentals</td>
<td>CM101MMXI Fundamentals</td>
<td>False</td>
<td>2013</td>
<td>139</td>
<td>Comedy,Documentary</td>
<td>9.2</td>
<td>41327</td>
</tr>
<tr>
<th>4</th>
<td>The Godfather</td>
<td>The Godfather</td>
<td>False</td>
<td>1972</td>
<td>175</td>
<td>Crime,Drama</td>
<td>9.2</td>
<td>1421495</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>245</th>
<td>12 Years a Slave</td>
<td>12 Years a Slave</td>
<td>False</td>
<td>2013</td>
<td>134</td>
<td>Biography,Drama,History</td>
<td>8.1</td>
<td>571204</td>
</tr>
<tr>
<th>246</th>
<td>The Sixth Sense</td>
<td>The Sixth Sense</td>
<td>False</td>
<td>1999</td>
<td>107</td>
<td>Drama,Mystery,Thriller</td>
<td>8.1</td>
<td>836928</td>
</tr>
<tr>
<th>247</th>
<td>The Passion of Joan of Arc</td>
<td>La passion de Jeanne d'Arc</td>
<td>False</td>
<td>1928</td>
<td>110</td>
<td>Biography,Drama,History</td>
<td>8.1</td>
<td>40107</td>
</tr>
<tr>
<th>248</th>
<td>Barfi!</td>
<td>Barfi!</td>
<td>False</td>
<td>2012</td>
<td>151</td>
<td>Comedy,Drama,Romance</td>
<td>8.1</td>
<td>68274</td>
</tr>
<tr>
<th>249</th>
<td>Platoon</td>
<td>Platoon</td>
<td>False</td>
<td>1986</td>
<td>120</td>
<td>Drama,War</td>
<td>8.1</td>
<td>348628</td>
</tr>
</tbody>
</table>
<p>250 rows Ã— 8 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Do vÃ½Ätu se nÃ¡m dostaly filmy, kterÃ© hranici hlasÅ¯ nepÅ™ekraÄujÃ­ o moc. MÃ¡me dÅ¯vodnÃ© podezÅ™enÃ­, Å¾e toto kritÃ©rium dÃ¡vno zmÄ›nili. S poÅ¾adovanÃ½mi 250 000 hlasy se uÅ¾ blÃ­Å¾Ã­me:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">movies_with_rating</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"imdb_votes &gt; 250000"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">"imdb_rating"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">250</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[29]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>The Shawshank Redemption</td>
<td>The Shawshank Redemption</td>
<td>False</td>
<td>1994</td>
<td>142</td>
<td>Drama</td>
<td>9.3</td>
<td>2071759</td>
</tr>
<tr>
<th>1</th>
<td>The Godfather</td>
<td>The Godfather</td>
<td>False</td>
<td>1972</td>
<td>175</td>
<td>Crime,Drama</td>
<td>9.2</td>
<td>1421495</td>
</tr>
<tr>
<th>2</th>
<td>The Dark Knight</td>
<td>The Dark Knight</td>
<td>False</td>
<td>2008</td>
<td>152</td>
<td>Action,Crime,Drama</td>
<td>9.0</td>
<td>2037678</td>
</tr>
<tr>
<th>3</th>
<td>The Godfather: Part II</td>
<td>The Godfather: Part II</td>
<td>False</td>
<td>1974</td>
<td>202</td>
<td>Crime,Drama</td>
<td>9.0</td>
<td>986451</td>
</tr>
<tr>
<th>4</th>
<td>Pulp Fiction</td>
<td>Pulp Fiction</td>
<td>False</td>
<td>1994</td>
<td>154</td>
<td>Crime,Drama</td>
<td>8.9</td>
<td>1620135</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>245</th>
<td>Ocean's Eleven</td>
<td>Ocean's Eleven</td>
<td>False</td>
<td>2001</td>
<td>116</td>
<td>Crime,Thriller</td>
<td>7.8</td>
<td>470530</td>
</tr>
<tr>
<th>246</th>
<td>Lost in Translation</td>
<td>Lost in Translation</td>
<td>False</td>
<td>2003</td>
<td>102</td>
<td>Drama</td>
<td>7.8</td>
<td>371577</td>
</tr>
<tr>
<th>247</th>
<td>Donnie Brasco</td>
<td>Donnie Brasco</td>
<td>False</td>
<td>1997</td>
<td>127</td>
<td>Biography,Crime,Drama</td>
<td>7.8</td>
<td>253811</td>
</tr>
<tr>
<th>248</th>
<td>Captain Phillips</td>
<td>Captain Phillips</td>
<td>False</td>
<td>2013</td>
<td>134</td>
<td>Biography,Drama,Thriller</td>
<td>7.8</td>
<td>384378</td>
</tr>
<tr>
<th>249</th>
<td>How to Train Your Dragon 2</td>
<td>How to Train Your Dragon 2</td>
<td>False</td>
<td>2014</td>
<td>102</td>
<td>Action,Adventure,Animation</td>
<td>7.8</td>
<td>273406</td>
</tr>
</tbody>
</table>
<p>250 rows Ã— 8 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="druhy_join">DruhÃ½ join
<a class="header-link" href="#druhy_join">#</a>
</h4>
<p>Co tabulka s vÃ½dÄ›lky (<code>boxoffice_raw</code>)?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">boxoffice_raw</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[30]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>rank</th>
<th>title</th>
<th>studio</th>
<th>lifetime_gross</th>
<th>year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>Star Wars: The Force Awakens</td>
<td>BV</td>
<td>936662225</td>
<td>2015</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>Avatar</td>
<td>Fox</td>
<td>760507625</td>
<td>2009</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>Black Panther</td>
<td>BV</td>
<td>700059566</td>
<td>2018</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>Avengers: Infinity War</td>
<td>BV</td>
<td>678815482</td>
<td>2018</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>Titanic</td>
<td>Par.</td>
<td>659363944</td>
<td>1997</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>16262</th>
<td>16263</td>
<td>Dog Eat Dog</td>
<td>IFC</td>
<td>80</td>
<td>2009</td>
</tr>
<tr>
<th>16263</th>
<td>16264</td>
<td>Paranoid Girls</td>
<td>NaN</td>
<td>78</td>
<td>2015</td>
</tr>
<tr>
<th>16264</th>
<td>16265</td>
<td>Confession of a Child of the Century</td>
<td>Cohen</td>
<td>74</td>
<td>2015</td>
</tr>
<tr>
<th>16265</th>
<td>16266</td>
<td>Storage 24</td>
<td>Magn.</td>
<td>72</td>
<td>2013</td>
</tr>
<tr>
<th>16266</th>
<td>16267</td>
<td>Zyzzyx Road</td>
<td>Reg.</td>
<td>30</td>
<td>2006</td>
</tr>
</tbody>
</table>
<p>16267 rows Ã— 5 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">boxoffice_raw</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[31]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>rank               int64
title             object
studio            object
lifetime_gross     int64
year               int64
dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>S tÃ­m bychom v podstatnÄ› mohli bÃ½t spokojenÃ­, jen pÅ™ejmenujeme <code>rank</code>, abychom pÅ™i joinovÃ¡nÃ­ vÄ›dÄ›li, odkud danÃ½ sloupec pochÃ¡zÃ­.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [32]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">boxoffice</span> <span class="o">=</span> <span class="p">(</span><span class="n">boxoffice_raw</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span>
        <span class="s2">"rank"</span><span class="p">:</span> <span class="s2">"boxoffice_rank"</span>
    <span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A zkusÃ­me joinovat. V tomto pÅ™Ã­padÄ› se nemÅ¯Å¾eme opÅ™Ã­t o index (<code>boxoffice</code> pochÃ¡zÃ­ z jinÃ©ho zdroje a o nÄ›jakÃ©m ID filmu z IMDb nemÃ¡ ani tuchy), ale explicitnÄ› specifikujeme, kterÃ½ sloupec (Äi sloupce) se musÃ­ shodovat - na to slouÅ¾Ã­ argument <code>on</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">movies_with_rating</span><span class="p">,</span>
    <span class="n">boxoffice</span><span class="p">,</span>
    <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s2">" (imdb)"</span><span class="p">,</span> <span class="s2">" (boxoffice)"</span><span class="p">],</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">"title"</span>
<span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"title == 'Pinocchio'"</span><span class="p">)</span>  <span class="c1"># "Jeden" ukÃ¡zkovÃ½ film</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[33]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year (imdb)</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
<th>boxoffice_rank</th>
<th>studio</th>
<th>lifetime_gross</th>
<th>year (boxoffice)</th>
</tr>
</thead>
<tbody>
<tr>
<th>1643</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>1940</td>
<td>88</td>
<td>Animation,Comedy,Family</td>
<td>7.5</td>
<td>114689</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1644</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>1940</td>
<td>88</td>
<td>Animation,Comedy,Family</td>
<td>7.5</td>
<td>114689</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
<tr>
<th>1645</th>
<td>Pinocchio</td>
<td>Turlis Abenteuer</td>
<td>False</td>
<td>1967</td>
<td>75</td>
<td>Adventure,Family,Fantasy</td>
<td>7.2</td>
<td>19</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1646</th>
<td>Pinocchio</td>
<td>Turlis Abenteuer</td>
<td>False</td>
<td>1967</td>
<td>75</td>
<td>Adventure,Family,Fantasy</td>
<td>7.2</td>
<td>19</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
<tr>
<th>1647</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>1971</td>
<td>79</td>
<td>Comedy,Fantasy</td>
<td>3.5</td>
<td>123</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1648</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>1971</td>
<td>79</td>
<td>Comedy,Fantasy</td>
<td>3.5</td>
<td>123</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
<tr>
<th>1649</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>1911</td>
<td>50</td>
<td>Fantasy</td>
<td>5.9</td>
<td>69</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1650</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>1911</td>
<td>50</td>
<td>Fantasy</td>
<td>5.9</td>
<td>69</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
<tr>
<th>1651</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>2002</td>
<td>108</td>
<td>Comedy,Family,Fantasy</td>
<td>4.3</td>
<td>7192</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1652</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>2002</td>
<td>108</td>
<td>Comedy,Family,Fantasy</td>
<td>4.3</td>
<td>7192</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
<tr>
<th>1653</th>
<td>Pinocchio</td>
<td>Un burattino di nome Pinocchio</td>
<td>False</td>
<td>1971</td>
<td>96</td>
<td>Animation,Family,Fantasy</td>
<td>7.0</td>
<td>117</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1654</th>
<td>Pinocchio</td>
<td>Un burattino di nome Pinocchio</td>
<td>False</td>
<td>1971</td>
<td>96</td>
<td>Animation,Family,Fantasy</td>
<td>7.0</td>
<td>117</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
<tr>
<th>1655</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>2012</td>
<td>75</td>
<td>Animation,Family,Fantasy</td>
<td>6.3</td>
<td>218</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1656</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>2012</td>
<td>75</td>
<td>Animation,Family,Fantasy</td>
<td>6.3</td>
<td>218</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
<tr>
<th>1657</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>2015</td>
<td>&lt;NA&gt;</td>
<td>Family,Fantasy</td>
<td>4.9</td>
<td>43</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1658</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>2015</td>
<td>&lt;NA&gt;</td>
<td>Family,Fantasy</td>
<td>4.9</td>
<td>43</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
<tr>
<th>1659</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>2015</td>
<td>75</td>
<td>Documentary</td>
<td>6.8</td>
<td>8</td>
<td>885</td>
<td>Dis.</td>
<td>84254167</td>
<td>1940</td>
</tr>
<tr>
<th>1660</th>
<td>Pinocchio</td>
<td>Pinocchio</td>
<td>False</td>
<td>2015</td>
<td>75</td>
<td>Documentary</td>
<td>6.8</td>
<td>8</td>
<td>6108</td>
<td>Mira.</td>
<td>3684305</td>
<td>2002</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Jejda, to jsme asi nechtÄ›li. Existuje spousta rÅ¯znÃ½ch PinocchiÅ¯ a ke kaÅ¾dÃ©mu z nich se pÅ™ipojili vÅ¾dy oba snÃ­mky tohoto jmÃ©na z <code>boxoffice</code>. Z toho vyplÃ½vÃ¡ pouÄenÃ­, Å¾e pÅ™i joinovÃ¡nÃ­ je dobrÃ© se zamyslet nad jedineÄnostÃ­ hodnot ve sloupci, kterÃ½ pouÅ¾Ã­vÃ¡me jako klÃ­Ä. JmÃ©no filmu takovÃ© oÄividnÄ› nenÃ­.</p>
<p>V naÅ¡em konkrÃ©tnÃ­m pÅ™Ã­padÄ› jsme si problÃ©mu vÅ¡imli sami, ale pokud bude duplikÃ¡tnÃ­ klÃ­Ä utopen nÄ›kde v milionech hodnot, rÃ¡di bychom, aby to poÄÃ­taÄ poznal za nÃ¡s. K tomu slouÅ¾Ã­ argument <code>validate</code> - podle toho, jakÃ½ vztah mezi tabulkami oÄekÃ¡Å¡, jsou pÅ™Ã­pustnÃ© hodnoty <code>"one_to_one"</code>, <code>"one_to_many"</code>, <code>"many_to_one"</code> nebo <code>"many_to_many"</code>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [34]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">movies_with_rating</span><span class="p">,</span>
    <span class="n">boxoffice</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">"title"</span><span class="p">,</span>
    <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s2">" (imdb)"</span><span class="p">,</span> <span class="s2">" (boxoffice)"</span><span class="p">],</span>
<span class="c1">#    validate="one_to_one"    # Odkomentuj a vyskoÄÃ­ chyba!</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[34]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year (imdb)</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
<th>boxoffice_rank</th>
<th>studio</th>
<th>lifetime_gross</th>
<th>year (boxoffice)</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Oliver Twist</td>
<td>Oliver Twist</td>
<td>False</td>
<td>1912</td>
<td>&lt;NA&gt;</td>
<td>Drama</td>
<td>4.7</td>
<td>19</td>
<td>6826</td>
<td>Sony</td>
<td>2080321</td>
<td>2005</td>
</tr>
<tr>
<th>1</th>
<td>Oliver Twist</td>
<td>Oliver Twist</td>
<td>False</td>
<td>1912</td>
<td>&lt;NA&gt;</td>
<td>Drama</td>
<td>4.4</td>
<td>12</td>
<td>6826</td>
<td>Sony</td>
<td>2080321</td>
<td>2005</td>
</tr>
<tr>
<th>2</th>
<td>Oliver Twist</td>
<td>Oliver Twist</td>
<td>False</td>
<td>1916</td>
<td>50</td>
<td>Drama</td>
<td>6.6</td>
<td>16</td>
<td>6826</td>
<td>Sony</td>
<td>2080321</td>
<td>2005</td>
</tr>
<tr>
<th>3</th>
<td>Oliver Twist</td>
<td>Oliver Twist</td>
<td>False</td>
<td>1922</td>
<td>98</td>
<td>Drama</td>
<td>6.8</td>
<td>657</td>
<td>6826</td>
<td>Sony</td>
<td>2080321</td>
<td>2005</td>
</tr>
<tr>
<th>4</th>
<td>Oliver Twist</td>
<td>Oliver Twist</td>
<td>False</td>
<td>1933</td>
<td>80</td>
<td>Drama</td>
<td>5.0</td>
<td>292</td>
<td>6826</td>
<td>Sony</td>
<td>2080321</td>
<td>2005</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>20562</th>
<td>BTS World Tour: Love Yourself in Seoul</td>
<td>BTS World Tour: Love Yourself in Seoul</td>
<td>False</td>
<td>2019</td>
<td>112</td>
<td>Documentary,Music</td>
<td>8.5</td>
<td>439</td>
<td>6173</td>
<td>Fathom</td>
<td>3509917</td>
<td>2019</td>
</tr>
<tr>
<th>20563</th>
<td>Mojin: The Worm Valley</td>
<td>Yun nan chong gu</td>
<td>False</td>
<td>2018</td>
<td>110</td>
<td>Action,Fantasy</td>
<td>4.7</td>
<td>120</td>
<td>11240</td>
<td>WGUSA</td>
<td>101516</td>
<td>2019</td>
</tr>
<tr>
<th>20564</th>
<td>Extreme Job</td>
<td>Geukhanjikeob</td>
<td>False</td>
<td>2019</td>
<td>111</td>
<td>Action,Comedy</td>
<td>7.3</td>
<td>905</td>
<td>7212</td>
<td>CJ</td>
<td>1548816</td>
<td>2019</td>
</tr>
<tr>
<th>20565</th>
<td>Peppa Celebrates Chinese New Year</td>
<td>xiao zhu pei qi guo da nian</td>
<td>False</td>
<td>2019</td>
<td>81</td>
<td>Animation,Family</td>
<td>3.4</td>
<td>41</td>
<td>10811</td>
<td>STX</td>
<td>131225</td>
<td>2019</td>
</tr>
<tr>
<th>20566</th>
<td>Avant qu'on explose</td>
<td>Avant qu'on explose</td>
<td>False</td>
<td>2019</td>
<td>108</td>
<td>Comedy</td>
<td>6.9</td>
<td>41</td>
<td>10995</td>
<td>EOne</td>
<td>116576</td>
<td>2019</td>
</tr>
</tbody>
</table>
<p>20567 rows Ã— 12 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Å˜eÅ¡enÃ­ je jednoduchÃ© - budeme joinovat pÅ™es dva rÅ¯znÃ© sloupce (argument <code>on</code> to unese ;-)). PÅ™i tÃ© pÅ™Ã­leÅ¾itosti navÃ­c zjiÅ¡Å¥ujeme, Å¾e nedÃ¡vÃ¡ smysl spojovat filmy, kterÃ© rok vÅ¯bec uvedenÃ½ nemajÃ­, a proto je vyhodÃ­me:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [35]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">movies_with_rating</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"year"</span><span class="p">]),</span>  <span class="c1"># VyhoÄ vÅ¡echny Å™Ã¡dky bez roku</span>
        <span class="n">boxoffice</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"year"</span><span class="p">],</span>
        <span class="n">validate</span><span class="o">=</span><span class="s2">"many_to_one"</span><span class="p">,</span>      <span class="c1"># movies_with_rating poÅ™Ã¡d nejsou unikÃ¡tnÃ­!</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"title == 'Playback'"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[35]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
<th>boxoffice_rank</th>
<th>studio</th>
<th>lifetime_gross</th>
</tr>
</thead>
<tbody>
<tr>
<th>6926</th>
<td>Playback</td>
<td>Playback</td>
<td>False</td>
<td>2012</td>
<td>98</td>
<td>Horror,Thriller</td>
<td>4.3</td>
<td>4478</td>
<td>16256</td>
<td>Magn.</td>
<td>264</td>
</tr>
<tr>
<th>6927</th>
<td>Playback</td>
<td>Playback</td>
<td>False</td>
<td>2012</td>
<td>113</td>
<td>Drama</td>
<td>4.9</td>
<td>27</td>
<td>16256</td>
<td>Magn.</td>
<td>264</td>
</tr>
<tr>
<th>6928</th>
<td>Playback</td>
<td>Dur d'Ãªtre Dieu</td>
<td>False</td>
<td>2012</td>
<td>66</td>
<td>Documentary</td>
<td>5.2</td>
<td>8</td>
<td>16256</td>
<td>Magn.</td>
<td>264</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>PoÅ™Ã¡d nejsou unikÃ¡tnÃ­! Co s tÃ­m?</p>
<p><strong>HypotÃ©za:</strong> Vstupujeme na nebezpeÄnou pÅ¯du a zkusÃ­me spekulovat, Å¾e informace o ziscÃ­ch budeme mÃ­t nejspÃ­Å¡ jen o nejpopulÃ¡rnÄ›jÅ¡Ã­ch filmech. MoÅ¾nÃ¡ mÃ¡me pravdu, moÅ¾nÃ¡ ne a nejspÃ­Å¡ nÄ›jakou drobnou nepÅ™esnost zaneseme, ale dobrat se tady skuteÄnÃ© pravdy je "drahÃ©" (a moÅ¾nÃ¡ i skuteÄnÄ› drahÃ©), z nabÃ­zenÃ½ch datovÃ½ch sad to vÄ›rohodnÄ› moÅ¾nÃ© nenÃ­.</p>
<p>Abychom se co nejvÃ­c pÅ™iblÃ­Å¾ili realitÄ›, z kaÅ¾dÃ© opakujÃ­cÃ­ se dvojice (nÃ¡zev, rok) vybereme film s nejvyÅ¡Å¡Ã­m <code>imdb_votes</code>. NejdÅ™Ã­ve si pomocÃ­ <code>sort_values</code> srovnÃ¡me vÅ¡echny filmy a pak zavolÃ¡me <code>drop_duplicates(..., keep="first")</code>, coÅ¾ nÃ¡m ponechÃ¡ vÅ¾dy jen jeden z Å™ady duplikÃ¡tÅ¯:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [36]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">movies_with_rating_and_boxoffice</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">movies_with_rating</span>
            <span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"year"</span><span class="p">])</span>
            <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">"imdb_votes"</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
                <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"year"</span><span class="p">],</span>
                <span class="n">keep</span><span class="o">=</span><span class="s2">"first"</span>
            <span class="p">),</span>
        <span class="n">boxoffice</span><span class="p">,</span>
        <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"year"</span><span class="p">],</span>
        <span class="n">validate</span><span class="o">=</span><span class="s2">"one_to_one"</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">movies_with_rating_and_boxoffice</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[36]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
<th>boxoffice_rank</th>
<th>studio</th>
<th>lifetime_gross</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>The Shawshank Redemption</td>
<td>The Shawshank Redemption</td>
<td>False</td>
<td>1994</td>
<td>142</td>
<td>Drama</td>
<td>9.3</td>
<td>2071759</td>
<td>2792</td>
<td>Col.</td>
<td>28341469</td>
</tr>
<tr>
<th>1</th>
<td>The Dark Knight</td>
<td>The Dark Knight</td>
<td>False</td>
<td>2008</td>
<td>152</td>
<td>Action,Crime,Drama</td>
<td>9.0</td>
<td>2037678</td>
<td>10</td>
<td>WB</td>
<td>535234033</td>
</tr>
<tr>
<th>2</th>
<td>Inception</td>
<td>Inception</td>
<td>False</td>
<td>2010</td>
<td>148</td>
<td>Action,Adventure,Sci-Fi</td>
<td>8.8</td>
<td>1816360</td>
<td>85</td>
<td>WB</td>
<td>292576195</td>
</tr>
<tr>
<th>3</th>
<td>Fight Club</td>
<td>Fight Club</td>
<td>False</td>
<td>1999</td>
<td>139</td>
<td>Drama</td>
<td>8.8</td>
<td>1657857</td>
<td>2248</td>
<td>Fox</td>
<td>37030102</td>
</tr>
<tr>
<th>4</th>
<td>Pulp Fiction</td>
<td>Pulp Fiction</td>
<td>False</td>
<td>1994</td>
<td>154</td>
<td>Crime,Drama</td>
<td>8.9</td>
<td>1620135</td>
<td>629</td>
<td>Mira.</td>
<td>107928762</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>8996</th>
<td>Girlfriends</td>
<td>Girlfriends</td>
<td>False</td>
<td>1996</td>
<td>&lt;NA&gt;</td>
<td>NaN</td>
<td>8.6</td>
<td>7</td>
<td>13930</td>
<td>FRun</td>
<td>18000</td>
</tr>
<tr>
<th>8997</th>
<td>Sacred</td>
<td>Sacred</td>
<td>False</td>
<td>2017</td>
<td>&lt;NA&gt;</td>
<td>Action,Drama,Romance</td>
<td>8.2</td>
<td>6</td>
<td>13950</td>
<td>Argo.</td>
<td>17740</td>
</tr>
<tr>
<th>8998</th>
<td>The Professor: Tai Chi's Journey West</td>
<td>The Professor: Tai Chi's Journey West</td>
<td>False</td>
<td>2016</td>
<td>72</td>
<td>Documentary</td>
<td>7.2</td>
<td>6</td>
<td>15820</td>
<td>FRun</td>
<td>2852</td>
</tr>
<tr>
<th>8999</th>
<td>After Love</td>
<td>After Love</td>
<td>False</td>
<td>2017</td>
<td>&lt;NA&gt;</td>
<td>Drama,Romance,Thriller</td>
<td>7.6</td>
<td>5</td>
<td>14299</td>
<td>Distrib.</td>
<td>13693</td>
</tr>
<tr>
<th>9000</th>
<td>Still, the Children Are Here</td>
<td>Still, the Children Are Here</td>
<td>False</td>
<td>2004</td>
<td>85</td>
<td>Documentary</td>
<td>6.6</td>
<td>5</td>
<td>15653</td>
<td>Icar.</td>
<td>3685</td>
</tr>
</tbody>
</table>
<p>9001 rows Ã— 11 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [37]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># To uÅ¾ by Å¡lo!</span>
<span class="n">movies_with_rating_and_boxoffice</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"title == 'Playback'"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[37]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
<th>boxoffice_rank</th>
<th>studio</th>
<th>lifetime_gross</th>
</tr>
</thead>
<tbody>
<tr>
<th>5831</th>
<td>Playback</td>
<td>Playback</td>
<td>False</td>
<td>2012</td>
<td>98</td>
<td>Horror,Thriller</td>
<td>4.3</td>
<td>4478</td>
<td>16256</td>
<td>Magn.</td>
<td>264</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Ãškol:</strong> SeÅ™aÄ filmy podle toho, kolik vydÄ›laly (nabÃ­zÃ­ se hned dvÄ› moÅ¾nosti).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>OtÃ¡zka:</strong> KterÃ© filmy nÃ¡m vypadly a proÄ?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="treti_join">TÅ™etÃ­ join
<a class="header-link" href="#treti_join">#</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rotten_tomatoes_raw</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[38]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Rank</th>
<th>Title</th>
<th>RatingTomatometer</th>
<th>No. of Reviews</th>
<th>Genres</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>Black Panther (2018)</td>
<td>97</td>
<td>444</td>
<td>action|adventure</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>Mad Max: Fury Road (2015)</td>
<td>97</td>
<td>394</td>
<td>action|adventure</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>Wonder Woman (2017)</td>
<td>93</td>
<td>410</td>
<td>action|adventure</td>
</tr>
<tr>
<th>3</th>
<td>4</td>
<td>Metropolis (1927)</td>
<td>99</td>
<td>118</td>
<td>action|adventure</td>
</tr>
<tr>
<th>4</th>
<td>5</td>
<td>Coco (2017)</td>
<td>97</td>
<td>308</td>
<td>action|adventure</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1585</th>
<td>70</td>
<td>Priest (2011)</td>
<td>15</td>
<td>97</td>
<td>western</td>
</tr>
<tr>
<th>1586</th>
<td>71</td>
<td>American Outlaws (2001)</td>
<td>14</td>
<td>103</td>
<td>western</td>
</tr>
<tr>
<th>1587</th>
<td>72</td>
<td>September Dawn (2007)</td>
<td>15</td>
<td>54</td>
<td>western</td>
</tr>
<tr>
<th>1588</th>
<td>73</td>
<td>Jonah Hex (2010)</td>
<td>12</td>
<td>147</td>
<td>western</td>
</tr>
<tr>
<th>1589</th>
<td>74</td>
<td>Texas Rangers (2001)</td>
<td>2</td>
<td>51</td>
<td>western</td>
</tr>
</tbody>
</table>
<p>1590 rows Ã— 5 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rotten_tomatoes_raw</span><span class="p">[</span><span class="s2">"Title"</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[39]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>Title
Yellow Submarine (1968)                                 6
101 Dalmatians (1961)                                   5
Fantasia (1940)                                         5
Harry Potter and the Deathly Hallows - Part 2 (2011)    5
Miracle on 34th Street (1947)                           5
                                                       ..
Misery (1990)                                           1
The Dead Zone (1983)                                    1
The Conjuring (2013)                                    1
The Exorcist (1973)                                     1
Texas Rangers (2001)                                    1
Name: count, Length: 947, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A zase duplicity, nÄ›kterÃ© nÃ¡zvy se nÃ¡m opakujÃ­ :-(</p>
<p><strong>OtÃ¡zka:</strong> DokÃ¡Å¾eÅ¡ zjistit proÄ? NÃ¡povÄ›da: podÃ­vej se na nÄ›jakÃ½ konkrÃ©tnÃ­ film.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>NaÅ¡tÄ›stÃ­ uÅ¾ vÃ­me, jak na to - pouÅ¾ijeme metodu <code>drop_duplicates</code>, tentokrÃ¡t pÅ™es sloupec <code>"Title"</code>. (PoznÃ¡mka: druhou moÅ¾nostÃ­ by bylo slouÄit vÅ¡echny rÅ¯znÃ© Å¾Ã¡nry danÃ©ho filmu do jednÃ© buÅˆky).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [40]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rotten_tomatoes_nodup</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">rotten_tomatoes_raw</span>
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span>
        <span class="n">subset</span><span class="o">=</span><span class="s2">"Title"</span><span class="p">,</span>
        <span class="n">keep</span><span class="o">=</span><span class="s2">"first"</span>                   <span class="c1"># Vybereme prvnÃ­ vÃ½skyt, lze i "last" (anebo False =&gt; vyhodit vÅ¡echny)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Genres"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>    <span class="c1"># InformaÄnÃ­ hodnotu jsme uÅ¾ ztratili</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">"Rank"</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>      <span class="c1"># MÄ›lo smysl jen v rÃ¡mci Å¾Ã¡nru</span>
<span class="p">)</span>
<span class="n">rotten_tomatoes_nodup</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[40]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Title</th>
<th>RatingTomatometer</th>
<th>No. of Reviews</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Black Panther (2018)</td>
<td>97</td>
<td>444</td>
</tr>
<tr>
<th>1</th>
<td>Mad Max: Fury Road (2015)</td>
<td>97</td>
<td>394</td>
</tr>
<tr>
<th>2</th>
<td>Wonder Woman (2017)</td>
<td>93</td>
<td>410</td>
</tr>
<tr>
<th>3</th>
<td>Metropolis (1927)</td>
<td>99</td>
<td>118</td>
</tr>
<tr>
<th>4</th>
<td>Coco (2017)</td>
<td>97</td>
<td>308</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1585</th>
<td>Priest (2011)</td>
<td>15</td>
<td>97</td>
</tr>
<tr>
<th>1586</th>
<td>American Outlaws (2001)</td>
<td>14</td>
<td>103</td>
</tr>
<tr>
<th>1587</th>
<td>September Dawn (2007)</td>
<td>15</td>
<td>54</td>
</tr>
<tr>
<th>1588</th>
<td>Jonah Hex (2010)</td>
<td>12</td>
<td>147</td>
</tr>
<tr>
<th>1589</th>
<td>Texas Rangers (2001)</td>
<td>2</td>
<td>51</td>
</tr>
</tbody>
</table>
<p>947 rows Ã— 3 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [41]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Ready to merge?</span>
<span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">imdb_titles</span><span class="p">,</span> <span class="n">rotten_tomatoes_nodup</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">"title"</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">"Title"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[41]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title_type</th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>start_year</th>
<th>end_year</th>
<th>length</th>
<th>genres</th>
<th>Title</th>
<th>RatingTomatometer</th>
<th>No. of Reviews</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>0 Å™Ã¡dkÅ¯!</p>
<p>Dosud jsme manipulovali s Å™Ã¡dky a sloupci jako celky, nicmÃ©nÄ› teÄ musÃ­me zasahovat pÅ™Ã­mo do hodnot v buÅˆkÃ¡ch. I to se pÅ™i sluÄovÃ¡nÃ­ dat z rÅ¯znÃ½ch zdrojÅ¯ nezÅ™Ã­dka stÃ¡vÃ¡. StojÃ­me pÅ™ed Ãºkolem pÅ™evÃ©st Å™etÄ›zce typu "Black Panther (2018)" na dvÄ› hodnoty: nÃ¡zev "Black Panther" a rok 2018 (jeden sloupec na dva).</p>
<p>NaÅ¡tÄ›stÃ­ si ty sloupce umÃ­me jednoduÅ¡e vyrobit pomocÃ­ Å™etÄ›zcovÃ© metody <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.slice.html"><code>.str.slice</code></a>, kterÃ¡ z kaÅ¾dÃ©ho Å™etÄ›zce vyÅ™Ã­zne nÄ›jakou jeho ÄÃ¡st (a zase pracuje na celÃ©m sloupci - vÃ½sledkem bude novÃ½ sloupec s funkcÃ­ aplikovanou na kaÅ¾dou z hodnot). Budeme vÄ›Å™it, Å¾e pÅ™edposlednÃ­ ÄtyÅ™i znaky pÅ™edstavujÃ­ rok a zbytek, aÅ¾ na nÄ›jakÃ© ty zÃ¡vorky, tvoÅ™Ã­ skuteÄnÃ½ nÃ¡zev:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [42]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rotten_tomatoes_beta</span> <span class="o">=</span> <span class="p">(</span><span class="n">rotten_tomatoes_nodup</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="n">rotten_tomatoes_nodup</span><span class="p">[</span><span class="s2">"Title"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">),</span>             
        <span class="n">year</span><span class="o">=</span><span class="n">rotten_tomatoes_nodup</span><span class="p">[</span><span class="s2">"Title"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">({</span>
        <span class="s2">"RatingTomatometer"</span><span class="p">:</span> <span class="s2">"tomatoes_rating"</span><span class="p">,</span>
        <span class="s2">"No. of Reviews"</span><span class="p">:</span> <span class="s2">"tomatoes_votes"</span><span class="p">,</span>
    <span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">"Title"</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s2">"columns"</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">rotten_tomatoes_beta</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[42]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>tomatoes_rating</th>
<th>tomatoes_votes</th>
<th>title</th>
<th>year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>97</td>
<td>444</td>
<td>Black Panther</td>
<td>2018</td>
</tr>
<tr>
<th>1</th>
<td>97</td>
<td>394</td>
<td>Mad Max: Fury Road</td>
<td>2015</td>
</tr>
<tr>
<th>2</th>
<td>93</td>
<td>410</td>
<td>Wonder Woman</td>
<td>2017</td>
</tr>
<tr>
<th>3</th>
<td>99</td>
<td>118</td>
<td>Metropolis</td>
<td>1927</td>
</tr>
<tr>
<th>4</th>
<td>97</td>
<td>308</td>
<td>Coco</td>
<td>2017</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1585</th>
<td>15</td>
<td>97</td>
<td>Priest</td>
<td>2011</td>
</tr>
<tr>
<th>1586</th>
<td>14</td>
<td>103</td>
<td>American Outlaws</td>
<td>2001</td>
</tr>
<tr>
<th>1587</th>
<td>15</td>
<td>54</td>
<td>September Dawn</td>
<td>2007</td>
</tr>
<tr>
<th>1588</th>
<td>12</td>
<td>147</td>
<td>Jonah Hex</td>
<td>2010</td>
</tr>
<tr>
<th>1589</th>
<td>2</td>
<td>51</td>
<td>Texas Rangers</td>
<td>2001</td>
</tr>
</tbody>
</table>
<p>947 rows Ã— 4 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ZÃ¡vorkovÃ¡ odysea nekonÄÃ­, nÄ›kdo nÃ¡m proaktivnÄ› do zÃ¡vorek nacpal i originÃ¡lnÃ­ nÃ¡zev naanglickojazyÄnÃ½ch filmÅ¯. PojÄme se o tom pÅ™esvÄ›dÄit pomocÃ­ metody <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.contains.html"><code>.str.contains</code></a> (protoÅ¾e tato metoda ve vÃ½chozÃ­m stavu pouÅ¾Ã­vÃ¡ pro vyhledÃ¡vÃ¡nÃ­ regulÃ¡rnÃ­ vÃ½razy, kterÃ© jsme se zatÃ­m nenauÄili pouÅ¾Ã­vat, musÃ­me jÃ­ to explicitnÄ› zakÃ¡zat argumentem <code>regex=False</code>):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [43]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rotten_tomatoes_beta</span><span class="p">[</span><span class="n">rotten_tomatoes_beta</span><span class="p">[</span><span class="s2">"title"</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">")"</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[43]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>tomatoes_rating</th>
<th>tomatoes_votes</th>
<th>title</th>
<th>year</th>
</tr>
</thead>
<tbody>
<tr>
<th>15</th>
<td>100</td>
<td>58</td>
<td>Seven Samurai (Shichinin no Samurai)</td>
<td>1956</td>
</tr>
<tr>
<th>51</th>
<td>98</td>
<td>46</td>
<td>Aguirre, the Wrath of God (Aguirre, der Zorn G...</td>
<td>1972</td>
</tr>
<tr>
<th>61</th>
<td>97</td>
<td>71</td>
<td>Ghostbusters (1984 Original)</td>
<td>1984</td>
</tr>
<tr>
<th>69</th>
<td>98</td>
<td>47</td>
<td>A Fistful of Dollars (Per un Pugno di Dollari)</td>
<td>1964</td>
</tr>
<tr>
<th>99</th>
<td>96</td>
<td>139</td>
<td>Embrace Of The Serpent (El Abrazo De La Serpie...</td>
<td>2016</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1368</th>
<td>97</td>
<td>59</td>
<td>To Be and to Have (Etre et Avoir)</td>
<td>2003</td>
</tr>
<tr>
<th>1457</th>
<td>43</td>
<td>82</td>
<td>Goal! The Dream Begins (Goal!: The Impossible ...</td>
<td>2005</td>
</tr>
<tr>
<th>1502</th>
<td>71</td>
<td>52</td>
<td>Only Human (Seres queridos)</td>
<td>2006</td>
</tr>
<tr>
<th>1547</th>
<td>83</td>
<td>64</td>
<td>The Good, the Bad, the Weird (Joheun-nom, Nabb...</td>
<td>2010</td>
</tr>
<tr>
<th>1559</th>
<td>74</td>
<td>62</td>
<td>Fah talai jone (Tears of the Black Tiger)</td>
<td>2007</td>
</tr>
</tbody>
</table>
<p>66 rows Ã— 4 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>V rÃ¡mci zjednoduÅ¡enÃ­ proto jeÅ¡tÄ› odstranÃ­me vÅ¡echny takovÃ© zÃ¡vorky. K tomu pomÅ¯Å¾e funkce <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.rsplit.html"><code>.str.rsplit</code></a>, kterÃ¡ rozdÄ›lÃ­ zprava Å™etÄ›zec na nÄ›kolik ÄÃ¡stÃ­ podle oddÄ›lovaÄe a vloÅ¾Ã­ je do seznamu - my za ten oddÄ›lovaÄ zvolÃ­me levou zÃ¡vorku <code>"("</code>, omezÃ­me poÄet ÄÃ¡stÃ­ na jednu aÅ¾ dvÄ› (<code>n=1</code>):</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [44]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">split_title</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">rotten_tomatoes_beta</span><span class="p">[</span><span class="s2">"title"</span><span class="p">]</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">"("</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">split_title</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">81</span><span class="p">]]</span>   <span class="c1"># NÄ›kterÃ© seznamy obsahujÃ­ jeden prvek, jinÃ© dva</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[44]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>41            [Marvel's The Avengers]
61    [Ghostbusters , 1984 Original)]
81      [Mad Max 2: The Road Warrior]
Name: title, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A jak teÄ vybrat prvnÃ­ prvek z kaÅ¾dÃ©ho seznamu?</p>
<p>ğŸ’¡ Metoda <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.apply.html"><code>apply</code></a> umoÅ¾Åˆuje pouÅ¾Ã­t libovolnou transformaci (definovanou jako funkci) na kaÅ¾dÃ½ Å™Ã¡dek v tabulce Äi hodnotu v <code>Series</code>. Obvykle se bez nÃ­ obejdeme a mÄ›li bychom (proto se jÃ­ tolik speciÃ¡lnÄ› nevÄ›nujeme), protoÅ¾e nenÃ­ pÅ™Ã­liÅ¡ vÃ½poÄetnÄ› efektivnÃ­. Tady nÃ¡m ale usnadnÃ­ pochopenÃ­, co se vlastnÄ› dÄ›lÃ¡, t.j. vybÃ­rÃ¡ prvnÃ­ prvek nÄ›jakÃ©ho seznamu:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [45]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">take_first</span><span class="p">(</span><span class="n">a_list</span><span class="p">):</span>   <span class="c1"># Funkce, kterou pouÅ¾ijeme v apply</span>
    <span class="k">return</span> <span class="n">a_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">rotten_tomatoes</span> <span class="o">=</span> <span class="p">(</span><span class="n">rotten_tomatoes_beta</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="n">split_title</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">take_first</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">rotten_tomatoes</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[45]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>tomatoes_rating</th>
<th>tomatoes_votes</th>
<th>title</th>
<th>year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>97</td>
<td>444</td>
<td>Black Panther</td>
<td>2018</td>
</tr>
<tr>
<th>1</th>
<td>97</td>
<td>394</td>
<td>Mad Max: Fury Road</td>
<td>2015</td>
</tr>
<tr>
<th>2</th>
<td>93</td>
<td>410</td>
<td>Wonder Woman</td>
<td>2017</td>
</tr>
<tr>
<th>3</th>
<td>99</td>
<td>118</td>
<td>Metropolis</td>
<td>1927</td>
</tr>
<tr>
<th>4</th>
<td>97</td>
<td>308</td>
<td>Coco</td>
<td>2017</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1585</th>
<td>15</td>
<td>97</td>
<td>Priest</td>
<td>2011</td>
</tr>
<tr>
<th>1586</th>
<td>14</td>
<td>103</td>
<td>American Outlaws</td>
<td>2001</td>
</tr>
<tr>
<th>1587</th>
<td>15</td>
<td>54</td>
<td>September Dawn</td>
<td>2007</td>
</tr>
<tr>
<th>1588</th>
<td>12</td>
<td>147</td>
<td>Jonah Hex</td>
<td>2010</td>
</tr>
<tr>
<th>1589</th>
<td>2</td>
<td>51</td>
<td>Texas Rangers</td>
<td>2001</td>
</tr>
</tbody>
</table>
<p>947 rows Ã— 4 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># ZbavenÃ­ se duplikÃ¡tÅ¯ hned na zaÄÃ¡tku nÃ¡m zachovalo filmy se stejnÃ½m jmÃ©nem :-)</span>
<span class="n">rotten_tomatoes</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">"title == 'The Magnificent Seven'"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[46]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>tomatoes_rating</th>
<th>tomatoes_votes</th>
<th>title</th>
<th>year</th>
</tr>
</thead>
<tbody>
<tr>
<th>1539</th>
<td>88</td>
<td>42</td>
<td>The Magnificent Seven</td>
<td>1960</td>
</tr>
<tr>
<th>1560</th>
<td>63</td>
<td>289</td>
<td>The Magnificent Seven</td>
<td>2016</td>
</tr>
</tbody>
</table>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [47]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">movies</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">"year"</span><span class="p">]),</span>
    <span class="n">rotten_tomatoes</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"year"</span><span class="p">],</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">"inner"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[47]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>tomatoes_rating</th>
<th>tomatoes_votes</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>The Birth of a Nation</td>
<td>The Birth of a Nation</td>
<td>False</td>
<td>1915</td>
<td>195</td>
<td>Drama,History,War</td>
<td>98</td>
<td>40</td>
</tr>
<tr>
<th>1</th>
<td>Battleship Potemkin</td>
<td>Bronenosets Potemkin</td>
<td>False</td>
<td>1925</td>
<td>75</td>
<td>Drama,History</td>
<td>100</td>
<td>45</td>
</tr>
<tr>
<th>2</th>
<td>The Gold Rush</td>
<td>The Gold Rush</td>
<td>False</td>
<td>1925</td>
<td>95</td>
<td>Adventure,Comedy,Drama</td>
<td>100</td>
<td>43</td>
</tr>
<tr>
<th>3</th>
<td>Metropolis</td>
<td>Metropolis</td>
<td>False</td>
<td>1927</td>
<td>153</td>
<td>Drama,Sci-Fi</td>
<td>99</td>
<td>118</td>
</tr>
<tr>
<th>4</th>
<td>All Quiet on the Western Front</td>
<td>All Quiet on the Western Front</td>
<td>False</td>
<td>1930</td>
<td>136</td>
<td>Drama,War</td>
<td>100</td>
<td>42</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>654</th>
<td>Three Identical Strangers</td>
<td>Three Identical Strangers</td>
<td>False</td>
<td>2018</td>
<td>96</td>
<td>Biography,Documentary,Drama</td>
<td>96</td>
<td>157</td>
</tr>
<tr>
<th>655</th>
<td>Searching</td>
<td>Searching</td>
<td>False</td>
<td>2018</td>
<td>102</td>
<td>Drama,Mystery,Thriller</td>
<td>92</td>
<td>214</td>
</tr>
<tr>
<th>656</th>
<td>Won't You Be My Neighbor?</td>
<td>Won't You Be My Neighbor?</td>
<td>False</td>
<td>2018</td>
<td>94</td>
<td>Biography,Documentary</td>
<td>98</td>
<td>216</td>
</tr>
<tr>
<th>657</th>
<td>RBG</td>
<td>RBG</td>
<td>False</td>
<td>2018</td>
<td>98</td>
<td>Biography,Documentary</td>
<td>95</td>
<td>153</td>
</tr>
<tr>
<th>658</th>
<td>Hereditary</td>
<td>Hereditary</td>
<td>False</td>
<td>2018</td>
<td>127</td>
<td>Drama,Horror,Mystery</td>
<td>89</td>
<td>317</td>
</tr>
</tbody>
</table>
<p>659 rows Ã— 8 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>KdyÅ¾ slouÄÃ­me filmy a hodnocenÃ­ na Rotten Tomatoes, z 947 filmÅ¯ se nÃ¡m skoro tÅ™i sta ztratÃ­. BohuÅ¾el zde je na vinÄ› pÅ™edevÅ¡Ã­m nestejnost zÃ¡pisu nÃ¡zvu, rÅ¯znÃ© uÅ™ÄitÃ© Äleny, interpunkce, podnÃ¡zvy apod. Coby Å™eÅ¡enÃ­ se tady nabÃ­zÃ­ spousta a spousta manuÃ¡lnÃ­ prÃ¡ce, pÅ™Ã­padnÄ› nÄ›jakÃ¡ heuristika, kterÃ¡ by na sebe pasovala "hodnÄ› podobnÃ©" nÃ¡zvy.</p>
<p><em>Mimochodem, obtÃ­Å¾nost manuÃ¡lnÃ­ prÃ¡ce se mezi vÃ½vojÃ¡Å™i nÄ›kdy pÅ™eceÅˆuje: Opravit 288 nÃ¡zvÅ¯ filmÅ¯ mÅ¯Å¾e bÃ½t prÃ¡ce na hodinu aÅ¾ dvÄ›, zatÃ­mco psÃ¡t algoritmus na "Å™eÅ¡enÃ­ problÃ©mu" mÅ¯Å¾e trvat stejnÄ› dlouho, ne-li dÃ©le.</em></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="ctvrty_a_posledni_join">ÄŒtvrtÃ½ (a poslednÃ­) join
<a class="header-link" href="#ctvrty_a_posledni_join">#</a>
</h4>
<p>DokonÄÃ­me sluÄovÃ¡nÃ­ vÅ¡ech ÄtyÅ™ tabulek:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">InÂ [48]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">movies_complete</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">movies_with_rating_and_boxoffice</span><span class="p">,</span>
    <span class="n">rotten_tomatoes</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">"title"</span><span class="p">,</span> <span class="s2">"year"</span><span class="p">],</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">"inner"</span>
<span class="p">)</span>
<span class="n">movies_complete</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">"boxoffice_rank"</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[48]:</div>
<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style>.lesson-content .dataframe tbody tr th:only-of-type {
    vertical-align: middle
    }
.lesson-content .dataframe tbody tr th {
    vertical-align: top
    }
.lesson-content .dataframe thead th {
    text-align: right
    }</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>title</th>
<th>original_title</th>
<th>is_adult</th>
<th>year</th>
<th>length</th>
<th>genres</th>
<th>imdb_rating</th>
<th>imdb_votes</th>
<th>boxoffice_rank</th>
<th>studio</th>
<th>lifetime_gross</th>
<th>tomatoes_rating</th>
<th>tomatoes_votes</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Black Panther</td>
<td>Black Panther</td>
<td>False</td>
<td>2018</td>
<td>134</td>
<td>Action,Adventure,Sci-Fi</td>
<td>7.3</td>
<td>489977</td>
<td>3</td>
<td>BV</td>
<td>700059566</td>
<td>97</td>
<td>444</td>
</tr>
<tr>
<th>1</th>
<td>Avengers: Infinity War</td>
<td>Avengers: Infinity War</td>
<td>False</td>
<td>2018</td>
<td>149</td>
<td>Action,Adventure,Sci-Fi</td>
<td>8.5</td>
<td>616050</td>
<td>4</td>
<td>BV</td>
<td>678815482</td>
<td>84</td>
<td>408</td>
</tr>
<tr>
<th>2</th>
<td>Titanic</td>
<td>Titanic</td>
<td>False</td>
<td>1997</td>
<td>194</td>
<td>Drama,Romance</td>
<td>7.8</td>
<td>945889</td>
<td>5</td>
<td>Par.</td>
<td>659363944</td>
<td>89</td>
<td>184</td>
</tr>
<tr>
<th>3</th>
<td>Incredibles 2</td>
<td>Incredibles 2</td>
<td>False</td>
<td>2018</td>
<td>118</td>
<td>Action,Adventure,Animation</td>
<td>7.7</td>
<td>192301</td>
<td>9</td>
<td>BV</td>
<td>608581744</td>
<td>94</td>
<td>332</td>
</tr>
<tr>
<th>4</th>
<td>The Dark Knight</td>
<td>The Dark Knight</td>
<td>False</td>
<td>2008</td>
<td>152</td>
<td>Action,Crime,Drama</td>
<td>9.0</td>
<td>2037678</td>
<td>10</td>
<td>WB</td>
<td>535234033</td>
<td>94</td>
<td>332</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>469</th>
<td>Boxing Gym</td>
<td>Boxing Gym</td>
<td>False</td>
<td>2010</td>
<td>91</td>
<td>Documentary</td>
<td>7.1</td>
<td>389</td>
<td>12999</td>
<td>Zipp.</td>
<td>32476</td>
<td>95</td>
<td>42</td>
</tr>
<tr>
<th>470</th>
<td>Red Hill</td>
<td>Red Hill</td>
<td>False</td>
<td>2010</td>
<td>95</td>
<td>Thriller,Western</td>
<td>6.4</td>
<td>7844</td>
<td>13681</td>
<td>Strand</td>
<td>21087</td>
<td>78</td>
<td>65</td>
</tr>
<tr>
<th>471</th>
<td>City Lights</td>
<td>City Lights</td>
<td>False</td>
<td>1931</td>
<td>87</td>
<td>Comedy,Drama,Romance</td>
<td>8.5</td>
<td>144261</td>
<td>13827</td>
<td>UA</td>
<td>19181</td>
<td>98</td>
<td>45</td>
</tr>
<tr>
<th>472</th>
<td>Minding the Gap</td>
<td>Minding the Gap</td>
<td>False</td>
<td>2018</td>
<td>93</td>
<td>Documentary</td>
<td>8.1</td>
<td>4119</td>
<td>14471</td>
<td>Magn.</td>
<td>11998</td>
<td>100</td>
<td>63</td>
</tr>
<tr>
<th>473</th>
<td>The Autopsy of Jane Doe</td>
<td>The Autopsy of Jane Doe</td>
<td>False</td>
<td>2016</td>
<td>86</td>
<td>Horror,Mystery,Thriller</td>
<td>6.8</td>
<td>73965</td>
<td>14657</td>
<td>IFC</td>
<td>10474</td>
<td>87</td>
<td>98</td>
</tr>
</tbody>
</table>
<p>474 rows Ã— 13 columns</p>
</div></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A pÅ™iÅ¡li jsme o dalÅ¡Ã­ch 175 filmÅ¯.</p>
<p>Co dÃ¡l? Pokud by toto byl skuteÄnÃ½ Ãºkol, museli bychom se s tÃ­m nÄ›jak vypoÅ™Ã¡dat - zkoumat, proÄ kterÃ© Å™Ã¡dky nesedÃ­, v Äem se liÅ¡Ã­ nÃ¡zvy stejnÃ©ho filmu v rÅ¯znÃ½ch datovÃ½ch sadÃ¡ch, jinÃ½mi slovy <em>manuÃ¡lnÃ­ prÃ¡ce, prÃ¡ce, prÃ¡ce...</em></p>
<p>NaÅ¡tÄ›stÃ­ to je Ãºkol jen ukÃ¡zkovÃ½, a my mÅ¯Å¾eme bÃ½t spokojeni, Å¾e mÃ¡me sice neÃºplnou, ale pÅ™esto pouÅ¾itelnou datovou sadu :-)</p>
</div>
</div>
</div>



        </div>

        
        <hr class="lesson-end">

        
            <div class="alert alert-info">
                Toto je strÃ¡nka lekce z kurzu, kterÃ½ probÃ­hÃ¡ nebo probÄ›hl naÅ¾ivo s instruktorem.
                
            </div>
        


        
    <div class="row prev-next">
        
            
            
                
    <div class="col text-left">
        <a href="/2024/pydata-praha-podzim/sessions/eda4/">â†‘Â <span class="d-none d-sm-inline">Lekce: ExplorativnÃ­ datovÃ¡ analÃ½za a vÃ­ce zdrojÅ¯ / promÄ›nnÃ½ch</span></a>
    </div>

            
            
                
    <div class="col text-right">
        <a href="/2024/pydata-praha-podzim/pydata/pandas_correlations/"><span class="d-none d-sm-inline">Pandas - vztahy mezi vÃ­ce promÄ›nnÃ½mi</span>Â â†’</a>
    </div>

            
        
    </div>


        

    </div>
</div>



        <script type="text/javascript" src="/static/js/solutions.js"></script>

        <div class="footer container">
            <hr>
            <div class="lesson-attribution">
                
                    <p>
                        Uprav tuto strÃ¡nku na
                        <a href="https://github.com/PyDataCZ/pyladies-kurz/blob/main/lessons/pydata/pandas_joins/index.ipynb">
                            
                                <svg class="icon icon-github" viewBox="0 0 64 64">
<path d="M32 0 C14 0 0 14 0 32 0 53 19 62 22 62 24 62 24 61 24 60 L24 55 C17 57 14 53 13 50 13 50 13 49 11 47 10 46 6 44 10 44 13 44 15 48 15 48 18 52 22 51 24 50 24 48 26 46 26 46 18 45 12 42 12 31 12 27 13 24 15 22 15 22 13 18 15 13 15 13 20 13 24 17 27 15 37 15 40 17 44 13 49 13 49 13 51 20 49 22 49 22 51 24 52 27 52 31 52 42 45 45 38 46 39 47 40 49 40 52 L40 60 C40 61 40 62 42 62 45 62 64 53 64 32 64 14 50 0 32 0 Z" fill="currentColor" stroke-width="0"/>
</svg>
                            
                          GitHubu
                        </a>
                    </p>
                

                
    
        <p>Pro PyDataCZ napsal Jan Pipek, 2020.</p>
    

                
    <p>
        Licence:
        <a href="https://creativecommons.org/licenses/by-sa/4.0/">
            Creative Commons Attribution-ShareAlike 4.0 International
        </a>
    </p>
    

                
            </div>
        </div>

        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>

        

    </body>
</html>